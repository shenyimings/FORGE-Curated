{
    "path": "dataset-curated/reports/Cantina/cantina_euler_pr111_oct2025.pdf",
    "project_info": {
        "url": [
            "https://github.com/euler-xyz/euler-swap"
        ],
        "commit_id": [
            "9287ae4f"
        ],
        "address": [],
        "chain": "evm/base",
        "compiler_version": "n/a",
        "audit_date": "2025-10-26",
        "project_path": {
            "euler-swap": "dataset-curated/contracts/cantina_euler_pr111_oct2025.pdf-source"
        }
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ]
            },
            "title": "Default fee recipient can be set to zero address",
            "description": "The function setDefaultRecipient in EulerSwapProtocolFeeConfig.sol assigns the defaultRecipient without validating that the provided address is non-zero. This allows the default fee recipient to be set to the zero address, which may result in fees being burned instead of being sent to a valid recipient. This behavior breaks compatibility with the previous implementation, where fees sent to address(0) were deposited into the Euler account, thereby increasing the account's NAV. By allowing address(0), the system now risks losing fees permanently and disrupting expected economic flows.\nThe root cause is the lack of input validation in the setDefaultRecipient function. An attacker or misconfigured admin could set the recipient to address(0), leading to irreversible loss of fees collected from pools that rely on the default configuration.\nThis could be exploited by a malicious or compromised admin setting the default recipient to zero, or by accidental misconfiguration during deployment or updates.\nThe impact includes potential loss of protocol and liquidity provider fees, reduced trust in the system's economic model, and deviation from expected behavior in fee distribution.\n",
            "severity": "Low",
            "location": [
                "EulerSwapProtocolFeeConfig.sol#L56"
            ],
            "files": [
                "euler-swap/src/EulerSwapProtocolFeeConfig.sol"
            ]
        },
        {
            "id": 1,
            "category": {
                "1": [
                    "CWE-664"
                ],
                "2": [
                    "CWE-221"
                ],
                "3": [
                    "CWE-223"
                ],
                "4": [
                    "CWE-778"
                ]
            },
            "title": "Missing events for administrative state changes",
            "description": "The functions setAdmin, setDefault, setOverride, and removeOverride in EulerSwapProtocolFeeConfig.sol modify critical administrative state without emitting corresponding events. This omission reduces on-chain observability, making it difficult for external systems such as indexers, monitoring tools, and auditors to track configuration changes over time. Without events, detecting unauthorized or erroneous changes becomes significantly harder, increasing the risk during incident response and post-mortem analysis.\nThe root cause is the absence of event emissions in these functions, which is a deviation from standard smart contract design patterns that emphasize transparency and traceability.\nAn attacker who gains temporary admin access could make stealthy changes that are hard to detect, or legitimate changes could go unnoticed by governance or monitoring systems.\nThe impact is reduced transparency and auditability, which weakens operational security and complicates compliance and forensic investigations.\n",
            "severity": "Low",
            "location": [
                "EulerSwapProtocolFeeConfig.sol#L48-L65"
            ],
            "files": [
                "euler-swap/src/EulerSwapProtocolFeeConfig.sol"
            ]
        },
        {
            "id": 2,
            "category": {
                "1": [
                    "CWE-691"
                ],
                "2": [
                    "CWE-841"
                ]
            },
            "title": "Activation marks pool active before initialization completes",
            "description": "The activate function in EulerSwapManagement.sol sets the pool status to active (s.status = 1) before completing all initialization steps. If any external call or hook is invoked after this status change but before full initialization, the system may treat the pool as active while it is still in a partially initialized state. This could lead to inconsistent behavior or errors in dependent systems that assume full initialization upon seeing an active status.\nThe root cause is the premature state transition, which violates the principle of atomic initialization. The function does not use intermediate states (e.g., \"initializing\") to prevent premature access.\nAn attacker could potentially exploit this by triggering a dependent function or hook that interacts with the pool during this vulnerable window, possibly leading to incorrect state assumptions or reentrancy-like conditions if external calls are involved.\nThe impact includes potential logic errors, inconsistent state, and possible disruption of dependent systems that rely on correct pool status semantics.\n",
            "severity": "Low",
            "location": [
                "EulerSwapManagement.sol#L68"
            ],
            "files": [
                "euler-swap/src/EulerSwapManagement.sol"
            ]
        },
        {
            "id": 3,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1164"
                ],
                "3": [
                    "CWE-561"
                ]
            },
            "title": "Remove unused code",
            "description": "Multiple files in the codebase contain unused imports, error declarations, and event declarations. This includes files such as EulerSwapManagement.sol, FundsLib.sol, and UniswapHook.sol. Dead code increases code complexity, reduces readability, and can mislead developers about the actual functionality and dependencies of the system.\nThe root cause is the presence of leftover or obsolete code that was not cleaned up during development or refactoring.\nWhile not directly exploitable, this could lead to confusion during audits or future development, increasing the risk of introducing bugs due to misunderstanding the codebase.\nThe impact is reduced code maintainability and increased cognitive load for developers and auditors, potentially leading to oversight of real vulnerabilities.\n",
            "severity": "Informational",
            "location": [
                "EulerSwapManagement.sol#L4-L7",
                "EulerSwapManagement.sol#L22",
                "EulerSwap.sol#L21-L24",
                "FundsLib.sol#L10",
                "UniswapHook.sol#L19",
                "UniswapHook.sol#L21-L22"
            ],
            "files": [
                "euler-swap/src/EulerSwapManagement.sol",
                "euler-swap/src/libraries/FundsLib.sol",
                "euler-swap/src/UniswapHook.sol"
            ]
        },
        {
            "id": 4,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1059"
                ]
            },
            "title": "Improve code documentation",
            "description": "Several parts of the codebase lack adequate documentation. In FundsLib.depositAssets(), the NatSpec comment inaccurately describes error handling, mentioning only E_ZeroShares when both E_ZeroShares and ZeroShares are handled. Additionally, new contracts like EulerSwapManagement and EulerSwap are missing standard documentation headers and security contact annotations. The flash-swap callback function eulerSwapCall() in IEulerSwapCallee.sol has insufficient parameter documentation, which could mislead integrators.\nThe root cause is incomplete or outdated inline documentation, which fails to reflect the actual implementation or expected usage patterns.\nPoor documentation increases the risk of integration errors, especially for third-party developers using the protocol. Misunderstanding the behavior of functions like eulerSwapCall() could lead to incorrect settlement logic and financial loss for integrators.\nThe impact includes higher risk of integration bugs, reduced developer experience, and potential operational failures due to incorrect assumptions about function behavior.\n",
            "severity": "Informational",
            "location": [
                "IEulerSwapCallee.sol#L5-L10",
                "FundsLib.sol#L77"
            ],
            "files": [
                "euler-swap/src/interfaces/IEulerSwapCallee.sol"
            ]
        },
        {
            "id": 5,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1076"
                ],
                "3": [
                    "CWE-1078"
                ],
                "4": [
                    "CWE-1099"
                ]
            },
            "title": "Internal function delegateToManagementImpl violates conventions",
            "description": "The internal function delegateToManagementImpl() in EulerSwap.sol does not follow Solidity naming conventions, as it lacks the underscore prefix (_delegateToManagementImpl) typically used for internal and private functions. Additionally, the function is placed among public/external functions rather than being grouped at the bottom of the contract, which is the conventional location for internal and private functions.\nThe root cause is deviation from established code style and organization practices, which are intended to improve code readability and maintainability.\nWhile not a security vulnerability per se, this inconsistency can confuse developers and auditors, potentially leading to incorrect assumptions about function visibility or accessibility.\nThe impact is reduced code clarity and maintainability, increasing the likelihood of human error during future development or audits.\n",
            "severity": "Informational",
            "location": [
                "EulerSwap.sol#L32-L39"
            ],
            "files": [
                "euler-swap/src/EulerSwap.sol"
            ]
        },
        {
            "id": 6,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ],
                "3": [
                    "CWE-1287"
                ]
            },
            "title": "Do not use EVC sub-accounts as fee recipients",
            "description": "The functions setDefault and setOverride in EulerSwapProtocolFeeConfig, along with fee transfer logic in SwapLib, allow EVC sub-accounts to be set as fee recipients without remapping them to their owner addresses. Unlike other parts of the system (e.g., bond redemption), fee transfers use the recipient address directly, which means fees sent to an EVC sub-account may be lost because such accounts lack control keys.\nThe root cause is the lack of validation or remapping logic for EVC sub-accounts in the fee distribution path.\nAn admin could accidentally or intentionally set a sub-account as a fee recipient, resulting in irreversible loss of fees. This could be exploited by a malicious actor with admin privileges to drain protocol revenue.\nThe impact includes potential loss of LP and protocol fees, reduced trust in the system, and operational risk due to misconfiguration.\n",
            "severity": "Informational",
            "location": [],
            "files": [
                "euler-swap/src/EulerSwapProtocolFeeConfig.sol"
            ]
        },
        {
            "id": 7,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ],
                "3": [
                    "CWE-1287"
                ]
            },
            "title": "Admin address must not be an EVC sub-account",
            "description": "The setAdmin function in EulerSwapProtocolFeeConfig allows the admin to be set to an EVC sub-account, which cannot authenticate via standard mechanisms. The onlyAdmin modifier uses _authenticateCallerWithStandardContextState(true), which fails if the caller is a sub-account, effectively bricking administrative functions.\nThe root cause is the absence of validation to prevent EVC sub-accounts from being assigned as admin.\nIf the admin is set to a sub-account, critical administrative functions become permanently inaccessible, leading to a loss of governance control over the contract.\nThe impact is potential permanent loss of administrative control, rendering the contract immutable and unable to respond to emergencies or upgrades.\n",
            "severity": "Informational",
            "location": [
                "EulerSwapProtocolFeeConfig.sol#L38-L50"
            ],
            "files": [
                "euler-swap/src/EulerSwapProtocolFeeConfig.sol"
            ]
        },
        {
            "id": 8,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ]
            },
            "title": "Protocol fee override can target non existent pool",
            "description": "The setOverride function in EulerSwapProtocolFeeConfig allows setting fee overrides for any address, without verifying that the target is a valid EulerSwap pool. This enables the creation of configuration entries for non-existent or stale pool addresses, leading to cluttered and potentially misleading configuration state.\nThe root cause is the lack of validation against the pool registry or factory to confirm pool existence before storing an override.\nWhile not directly exploitable for financial gain, this could be used to create confusion during audits or operations, or to waste gas on\u65e0\u6548 configurations.\nThe impact is operational complexity, increased risk of misconfiguration, and reduced clarity in fee configuration management.\n",
            "severity": "Informational",
            "location": [
                "EulerSwapProtocolFeeConfig.sol#L61-L65"
            ],
            "files": [
                "euler-swap/src/EulerSwapProtocolFeeConfig.sol"
            ]
        }
    ]
}