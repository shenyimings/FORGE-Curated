{
    "path": "dataset-curated/reports/Zenith/Zenith Audit Report - Sofa Automator 2.0.pdf",
    "project_info": {
        "url": [
            "https://github.com/sofa-org/sofa-protocol"
        ],
        "commit_id": [
            "01cb2b51da23bf40d9a9d5bd445c4acb1dbb05c0"
        ],
        "address": [],
        "chain": "n/a",
        "compiler_version": "n/a",
        "audit_date": "2025-01-08",
        "project_path": {
            "sofa-protocol": "dataset-curated/contracts/Zenith Audit Report - Sofa Automator 2.0.pdf-source"
        }
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ],
                "3": [
                    "CWE-1287"
                ]
            },
            "title": "Missing validation for `createAutomator()`",
            "description": "The function `createAutomator()` lacks input validation to ensure the provided parameters are valid. This could allow the creation of an automator with invalid or unsupported configurations. The root cause is the absence of checks on critical input parameters. An attacker could potentially exploit this by creating malfunctioning automators, leading to user confusion or wasted gas. The impact is limited to operational inefficiencies and user experience, hence classified as low risk. However, the full details of exploitation and impact may be elaborated in the complete finding.\n",
            "severity": "Low",
            "location": [],
            "files": [
                "sofa-protocol/contracts/automators/AutomatorFactory.sol",
                "sofa-protocol/contracts/mocks/automators/CrvUSDAutomatorFactory.sol",
                "sofa-protocol/contracts/mocks/automators/RCHAutomatorFactory.sol",
                "sofa-protocol/contracts/mocks/automators/AutomatorBaseFactory.sol",
                "sofa-protocol/contracts/mocks/automators/StETHAutomatorFactory.sol"
            ]
        },
        {
            "id": 1,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-755"
                ],
                "3": [
                    "CWE-636"
                ]
            },
            "title": "`harvest()` could fail to collect protocol fee if automator owner is blacklisted",
            "description": "The `harvest()` function may fail to collect the protocol fee when the automator owner is blacklisted. While the fee collection logic is in place, it does not properly handle the case where the owner is blacklisted, potentially allowing fee leakage. The cause is a lack of conditional bypass or fallback mechanism for fee collection independent of owner status. An attacker could exploit this by getting blacklisted and still benefiting from system operations without paying fees. The impact is a potential loss of protocol revenue, though limited in scope. Full details may follow in subsequent sections.\n",
            "severity": "Low",
            "location": [],
            "files": [
                "sofa-protocol/contracts/automators/bases/AAVEAutomatorBase.sol",
                "sofa-protocol/contracts/automators/bases/CrvUSDAutomatorBase.sol",
                "sofa-protocol/contracts/automators/bases/RCHAutomatorBase.sol",
                "sofa-protocol/contracts/automators/bases/StETHAutomatorBase.sol",
                "sofa-protocol/contracts/automators/bases/AutomatorBase.sol"
            ]
        },
        {
            "id": 2,
            "category": {
                "1": [
                    "CWE-682"
                ],
                "2": [
                    "CWE-191"
                ]
            },
            "title": "Negative fee calculation for `burnProducts()` should not favor the Automator owner",
            "description": "The fee calculation in `burnProducts()` can result in negative values, which currently benefit the Automator owner by increasing their payout. This is due to an unchecked arithmetic operation that allows underflow or negative fee interpretation. An attacker who is an Automator owner could exploit this by triggering specific burn conditions to extract additional funds. The impact is an unfair distribution of fees and potential economic imbalance, though the risk is mitigated by access control. The project acknowledged the issue but accepted it for gas optimization. Further context may exist in the full report.\n",
            "severity": "Low",
            "location": [],
            "files": [
                "sofa-protocol/contracts/automators/bases/AAVEAutomatorBase.sol",
                "sofa-protocol/contracts/automators/bases/CrvUSDAutomatorBase.sol",
                "sofa-protocol/contracts/automators/bases/RCHAutomatorBase.sol",
                "sofa-protocol/contracts/automators/bases/StETHAutomatorBase.sol",
                "sofa-protocol/contracts/automators/bases/AutomatorBase.sol"
            ]
        },
        {
            "id": 3,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ],
                "3": [
                    "CWE-1287"
                ]
            },
            "title": "Users could waste credit on `createAutomator()` if the specified collateral is unsupported",
            "description": "Users calling `createAutomator()` may waste their credit if they specify a collateral type that is not supported by the system. This occurs due to the lack of a check for collateral support before deducting user credit. The root cause is the absence of a validation step prior to credit consumption. An attacker could trick users into using invalid collateral types, leading to loss of credit. The impact is limited to user gas and credit loss, hence classified as low. Resolution status indicates it was fixed, but full technical details may be in the complete finding.\n",
            "severity": "Low",
            "location": [],
            "files": [
                "sofa-protocol/contracts/automators/AutomatorFactory.sol",
                "sofa-protocol/contracts/automators/bases/AAVEAutomatorBase.sol",
                "sofa-protocol/contracts/mocks/automators/RCHAutomatorFactory.sol",
                "sofa-protocol/contracts/mocks/automators/AutomatorBaseFactory.sol",
                "sofa-protocol/contracts/automators/bases/RCHAutomatorBase.sol"
            ]
        }
    ]
}