{
    "path": "dataset-curated/reports/ChainSecurity/ChainSecurity_Gearbox_MigrationBot_Audit.pdf",
    "project_info": {
        "url": [
            "https://github.com/Gearbox-protocol/periphery-v3"
        ],
        "commit_id": [
            "f349923539cfb2136c0599b1f16e16b7fa7892fd",
            "f30752716e83ac3f8c6e7b7b97b57ac95e2a8c76",
            "0b1827d061f1d5340b71e6670bd3c56b47f55070"
        ],
        "address": null,
        "chain": "evm",
        "compiler_version": "n/a",
        "audit_date": "2025-07-14",
        "project_path": {
            "periphery-v3": "dataset-curated/contracts/ChainSecurity_Gearbox_MigrationBot_Audit.pdf-source"
        }
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-754"
                ]
            },
            "title": "Usage of ptOverride",
            "description": "1. **Description:** The ptOverride mapping was required to be populated for all phantom tokens, but this led to a potential failure in validation when comparing uniqueTransferred tokens and migratedCollateral.underlying, especially when ptOverride was not set but the underlying value was zero. This could disrupt the migration process for certain token configurations.\n2. **Cause:** The _validateParameters function incorrectly assumed ptOverride must be set for all phantom tokens and enforced a comparison without checking whether an override existed, leading to unnecessary reverts.\n3. **Exploitation:** An attacker or user attempting to migrate a credit account with a phantom token lacking a ptOverride entry could trigger a revert during validation, preventing a legitimate migration.\n4. **Impact:** The impact was limited to disruption of the migration functionality for specific token configurations, potentially blocking legitimate user operations. However, no fund loss or critical system failure was possible.\n",
            "severity": "Low",
            "location": [
                "AccountMigratorBot.sol::_validateParameters"
            ],
            "files": [
                "periphery-v3/contracts/migration/AccountMigratorBot.sol"
            ]
        },
        {
            "id": 1,
            "category": {
                "1": [
                    "CWE-693"
                ]
            },
            "title": "Missing Lock Check",
            "description": "1. **Description:** The AccountMigratorBot uses a lock mechanism to prevent reentrancy or unexpected state changes during migration. However, the lock was being set to true without first verifying that it was currently unlocked, which could lead to incorrect state transitions in edge cases.\n2. **Cause:** The implementation lacked a precondition check before modifying the lock state, violating secure coding practices for mutex-like mechanisms.\n3. **Exploitation:** In an unexpected execution trace (e.g., due to external reentrancy or low-level call manipulation), an attacker might force the lock to be set while already locked, potentially disrupting the expected control flow and leading to inconsistent state.\n4. **Impact:** The impact was low, as the core functionality remained intact and no direct fund loss was possible. However, it could lead to denial of service for migration operations under rare conditions.\n",
            "severity": "Informational",
            "location": [
                "AccountMigratorBot.sol"
            ],
            "files": [
                "periphery-v3/contracts/migration/AccountMigratorBot.sol"
            ]
        }
    ]
}