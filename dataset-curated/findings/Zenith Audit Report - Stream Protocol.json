{
    "path": "dataset-curated/reports/Zenith/Zenith Audit Report - Stream Protocol.pdf",
    "project_info": {
        "url": [
            "https://github.com/StreamDefi/contracts"
        ],
        "commit_id": [
            "21e5e7a566f1b89be2b03d5d5bfed2b5e4449b3c"
        ],
        "address": [
            null
        ],
        "chain": "evm",
        "compiler_version": "n/a",
        "audit_date": "2025-02-06",
        "project_path": {
            "contracts": "dataset-curated/contracts/Zenith Audit Report - Stream Protocol.pdf-source"
        }
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-682"
                ],
                "2": [
                    "CWE-1339"
                ]
            },
            "title": "Using tokens with 18 decimals leads to significant loss of funds when bridging across chains",
            "description": "1.  **Description:** The vulnerability involves incorrect handling of tokens with 18 decimal places during cross-chain bridging operations.\n2.  **Cause:** The system does not properly normalize or convert decimal differences between tokens, leading to miscalculations.\n3.  **Exploitation:** An attacker could deposit a high-decimal token and trigger a bridge operation, causing a disproportionate withdrawal on the destination chain.\n4.  **Impact:** Users may suffer significant loss of funds due to incorrect amount calculations during cross-chain transfers.\n",
            "severity": "Critical",
            "location": [
                "StableWrapper.sol",
                "StreamVault.sol"
            ],
            "files": [
                "contracts/src/StableWrapper.sol"
            ]
        },
        {
            "id": 1,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-754"
                ]
            },
            "title": "`instantUnstake` and `unstake` can be used to bypass `minimumSupply`",
            "description": "1.  **Description:** The `instantUnstake` and `unstake` functions do not enforce the `minimumSupply` requirement, allowing users to withdraw funds even when doing so would drop the total supply below the intended minimum threshold.\n2.  **Cause:** Missing validation checks in the unstake functions to ensure the `minimumSupply` is maintained after withdrawals.\n3.  **Exploitation:** An attacker could exploit this by rapidly unstaking small amounts to drain the vault below the minimum supply, potentially destabilizing the system.\n4.  **Impact:** The vault may fall below its minimum supply, affecting system stability and economic model integrity.\n",
            "severity": "Medium",
            "location": [
                "StreamVault.sol::instantUnstake",
                "StreamVault.sol::unstake"
            ],
            "files": [
                "contracts/src/StreamVault.sol"
            ]
        },
        {
            "id": 2,
            "category": {
                "1": [
                    "CWE-693"
                ],
                "2": [
                    "CWE-424"
                ]
            },
            "title": "The vault's `cap` can be bypassed, and the `minimumSupply` can be reached earlier than intended",
            "description": "1.  **Description:** There exists a logic flaw that allows the vault's deposit cap to be circumvented, and the minimum supply threshold to be reached prematurely.\n2.  **Cause:** Improper enforcement of deposit limits in certain code paths, possibly through indirect deposits or wrapper contracts.\n3.  **Exploitation:** An attacker could exploit this by routing deposits through alternative functions or contracts that do not enforce the cap or supply checks.\n4.  **Impact:** The vault could exceed its intended capacity or reach minimum supply too early, disrupting yield distribution and economic balance.\n",
            "severity": "Medium",
            "location": [
                "StreamVault.sol",
                "StableWrapper.sol"
            ],
            "files": [
                "contracts/src/StreamVault.sol"
            ]
        },
        {
            "id": 3,
            "category": {
                "1": [
                    "CWE-682"
                ]
            },
            "title": "Providing yield on the first `rollToNextRound` causes unexpected behavior",
            "description": "1.  **Description:** Yield calculation during the first round transition via `rollToNextRound` leads to incorrect or unexpected state changes.\n2.  **Cause:** The initialization logic does not properly handle the first yield distribution, possibly due to uninitialized price-per-share or zero base values.\n3.  **Exploitation:** An attacker could trigger `rollToNextRound` prematurely or manipulate the timing to receive disproportionate rewards.\n4.  **Impact:** Users may receive incorrect share allocations, leading to unfair distribution and potential loss of funds.\n",
            "severity": "Medium",
            "location": [
                "StreamVault.sol::rollToNextRound"
            ],
            "files": [
                "contracts/src/StreamVault.sol"
            ]
        },
        {
            "id": 4,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-754"
                ]
            },
            "title": "Short-term DoS in `processWithdrawals` function",
            "description": "1.  **Description:** The `processWithdrawals` function is susceptible to a short-term denial-of-service condition.\n2.  **Cause:** The function may revert under certain conditions, such as empty queues or invalid states, without proper error handling or fallbacks.\n3.  **Exploitation:** An attacker could trigger reverts by manipulating withdrawal queue states, preventing legitimate users from processing withdrawals.\n4.  **Impact:** Temporary disruption of withdrawal functionality, leading to user fund lockup and degraded user experience.\n",
            "severity": "Low",
            "location": [
                "StreamVault.sol::processWithdrawals"
            ],
            "files": [
                "contracts/src/StreamVault.sol"
            ]
        },
        {
            "id": 5,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ],
                "3": [
                    "CWE-1285"
                ],
                "4": [
                    "CWE-129"
                ]
            },
            "title": "`getSharesFromReceipt` function should check if the round from stakeReceipt is greater than 1",
            "description": "1.  **Description:** The `getSharesFromReceipt` function does not validate whether the referenced round is valid or initialized.\n2.  **Cause:** Missing boundary checks on the round number in the stake receipt.\n3.  **Exploitation:** Calling the function with an uninitialized or invalid round could return incorrect share values.\n4.  **Impact:** Incorrect share calculations could lead to user confusion or incorrect redemption amounts.\n",
            "severity": "Low",
            "location": [
                "StreamVault.sol::getSharesFromReceipt"
            ],
            "files": [
                "contracts/src/StreamVault.sol"
            ]
        },
        {
            "id": 6,
            "category": {
                "1": [
                    "CWE-664"
                ]
            },
            "title": "Setters for key state variables in the `StableWrapper` and `StreamVault` contracts should be considered for removal",
            "description": "1.  **Description:** Public setter functions for critical state variables increase attack surface and risk of accidental or malicious misconfiguration.\n2.  **Cause:** Unnecessary mutability of important parameters after initialization.\n3.  **Exploitation:** If access controls are ever compromised, an attacker could modify key parameters to destabilize the system.\n4.  **Impact:** Potential for governance bypass or parameter manipulation leading to financial loss.\n",
            "severity": "Low",
            "location": [
                "StableWrapper.sol",
                "StreamVault.sol"
            ],
            "files": [
                "contracts/src/StableWrapper.sol",
                "contracts/src/StreamVault.sol"
            ]
        },
        {
            "id": 7,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ]
            },
            "title": "Missing check for non-zero creditor address in `StreamVault::depositAndStake` function",
            "description": "1.  **Description:** The `depositAndStake` function does not validate that the creditor address is not zero.\n2.  **Cause:** Lack of input validation for address parameters.\n3.  **Exploitation:** A call with a zero address could result in lost funds or incorrect state updates.\n4.  **Impact:** Funds may be deposited to a null address, rendering them irrecoverable.\n",
            "severity": "Low",
            "location": [
                "StreamVault.sol::depositAndStake"
            ],
            "files": [
                "contracts/src/StreamVault.sol"
            ]
        },
        {
            "id": 8,
            "category": {
                "1": [
                    "CWE-693"
                ]
            },
            "title": "Missing balance cap check in `StreamVault::rollToNextRound` function",
            "description": "1.  **Description:** The `rollToNextRound` function does not enforce the vault's balance cap during round transitions.\n2.  **Cause:** Omission of cap validation before allowing new rounds to begin.\n3.  **Exploitation:** Deposits could push the vault over its intended cap, which is not checked at round rollover.\n4.  **Impact:** The vault may exceed its designed capacity, increasing risk exposure beyond acceptable levels.\n",
            "severity": "Low",
            "location": [
                "StreamVault.sol::rollToNextRound"
            ],
            "files": [
                "contracts/src/StreamVault.sol"
            ]
        },
        {
            "id": 9,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-754"
                ],
                "3": [
                    "CWE-394"
                ]
            },
            "title": "`rollToNextRound` could revert under certain conditions",
            "description": "1.  **Description:** The `rollToNextRound` function may unexpectedly revert due to unhandled edge cases.\n2.  **Cause:** Lack of defensive checks for zero balances, empty states, or external call failures.\n3.  **Exploitation:** An attacker could manipulate state to trigger reverts, disrupting protocol operations.\n4.  **Impact:** Protocol stalling, delayed round transitions, and user withdrawal delays.\n",
            "severity": "Low",
            "location": [
                "StreamVault.sol::rollToNextRound"
            ],
            "files": [
                "contracts/src/StreamVault.sol"
            ]
        },
        {
            "id": 10,
            "category": {
                "1": [
                    "CWE-691"
                ],
                "2": [
                    "CWE-1265"
                ]
            },
            "title": "`rescueTokens` inside `StreamVault` could cause issues",
            "description": "1.  **Description:** The `rescueTokens` function may allow unintended token recovery or create reentrancy risks.\n2.  **Cause:** Broad token transfer functionality without sufficient restrictions or checks.\n3.  **Exploitation:** Could be abused to drain tokens or interact with malicious contracts.\n4.  **Impact:** Potential loss of rescued tokens or unintended side effects during external calls.\n",
            "severity": "Low",
            "location": [
                "StreamVault.sol::rescueTokens"
            ],
            "files": [
                "contracts/src/StreamVault.sol"
            ]
        },
        {
            "id": 11,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ]
            },
            "title": "`transferAsset` inside `StableWrapper` could cause issues",
            "description": "1.  **Description:** The `transferAsset` function lacks safeguards and may lead to incorrect transfers.\n2.  **Cause:** Insufficient validation of recipient or amount.\n3.  **Exploitation:** Could be used to send tokens to invalid addresses or in incorrect amounts.\n4.  **Impact:** Loss of funds or incorrect state updates.\n",
            "severity": "Low",
            "location": [
                "StableWrapper.sol::transferAsset"
            ],
            "files": [
                "contracts/src/StableWrapper.sol"
            ]
        },
        {
            "id": 12,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-754"
                ]
            },
            "title": "`processWithdrawals` has a risk due to the lack of slippage/amount control",
            "description": "1.  **Description:** The `processWithdrawals` function does not enforce minimum amount or slippage tolerance during asset swaps or redemptions.\n2.  **Cause:** Absence of output amount guarantees.\n3.  **Exploitation:** An attacker could manipulate prices to receive less value than expected.\n4.  **Impact:** Users may suffer losses due to unfavorable execution conditions.\n",
            "severity": "Low",
            "location": [
                "StreamVault.sol::processWithdrawals"
            ],
            "files": [
                "contracts/src/StreamVault.sol"
            ]
        },
        {
            "id": 13,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ]
            },
            "title": "`StableWrapper` may not work properly when using certain tokens as assets",
            "description": "1.  **Description:** The `StableWrapper` contract may malfunction with non-standard ERC20 tokens.\n2.  **Cause:** Assumptions about token behavior (e.g., no fees on transfer) that do not hold for all tokens.\n3.  **Exploitation:** Using fee-on-transfer or rebasing tokens could break balance tracking.\n4.  **Impact:** Incorrect accounting, loss of funds, or failed transactions.\n",
            "severity": "Low",
            "location": [
                "StableWrapper.sol"
            ],
            "files": [
                "contracts/src/StableWrapper.sol"
            ]
        },
        {
            "id": 14,
            "category": {
                "1": [
                    "CWE-693"
                ]
            },
            "title": "Lack of slippage control in `unstake` and `unstakeAndWithdraw`",
            "description": "1.  **Description:** These functions do not enforce minimum output amounts during token unwrapping or withdrawals.\n2.  **Cause:** Missing slippage protection mechanisms.\n3.  **Exploitation:** Users may receive fewer tokens than expected during volatile market conditions.\n4.  **Impact:** Financial loss for users due to poor execution.\n",
            "severity": "Low",
            "location": [
                "StreamVault.sol::unstake",
                "StreamVault.sol::unstakeAndWithdraw"
            ],
            "files": [
                "contracts/src/StreamVault.sol"
            ]
        },
        {
            "id": 15,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ]
            },
            "title": "Dangerous usage of the `stableWrapper` balance inside `rollToNextRound`",
            "description": "1.  **Description:** The `rollToNextRound` function relies on the `stableWrapper` balance without considering external manipulations.\n2.  **Cause:** Trusting an external balance that could be inflated via minting or other means.\n3.  **Exploitation:** An attacker could inflate the balance to manipulate yield calculations.\n4.  **Impact:** Inflated share prices, unfair distribution, and potential loss of funds.\n",
            "severity": "Low",
            "location": [
                "StreamVault.sol::rollToNextRound"
            ],
            "files": [
                "contracts/src/StreamVault.sol"
            ]
        },
        {
            "id": 16,
            "category": {
                "1": [
                    "CWE-691"
                ],
                "2": [
                    "CWE-799"
                ]
            },
            "title": "Lack of time interval restrictions on `rollToNextRound` and `processWithdrawals`",
            "description": "1.  **Description:** These functions can be called repeatedly without enforced time delays.\n2.  **Cause:** Missing rate-limiting or cooldown mechanisms.\n3.  **Exploitation:** Could be spammed or called at inopportune times, disrupting protocol stability.\n4.  **Impact:** Increased gas costs, state instability, and potential manipulation of round timing.\n",
            "severity": "Informational",
            "location": [
                "StreamVault.sol::rollToNextRound",
                "StreamVault.sol::processWithdrawals"
            ],
            "files": [
                "contracts/src/StreamVault.sol"
            ]
        }
    ]
}