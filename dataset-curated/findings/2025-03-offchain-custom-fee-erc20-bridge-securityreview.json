{
    "path": "dataset-curated/reports/TrailofBits/2025-03-offchain-custom-fee-erc20-bridge-securityreview.pdf",
    "project_info": {
        "url": [
            "https://github.com/OffchainLabs/nitro-contracts/compare/v2.1.1...275ba6cc4af028e67beea29b77df32807f5aefa2",
            "https://github.com/OffchainLabs/orbit-actions/pull/38/commits/f4f878e101e54170080532ad3ba6e70dab56a2b9"
        ],
        "commit_id": [
            "275ba6cc4af028e67beea29b77df32807f5aefa2",
            "f4f878e101e54170080532ad3ba6e70dab56a2b9"
        ],
        "address": null,
        "chain": "evm",
        "compiler_version": "n/a",
        "audit_date": "2025-03-31",
        "project_path": {
            "2025-03-offchain-custom-fee-erc20-bridge-securityreview.pdf-source": "dataset-curated/contracts/2025-03-offchain-custom-fee-erc20-bridge-securityreview.pdf-source"
        }
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-691"
                ],
                "2": [
                    "CWE-841"
                ]
            },
            "title": "An invalid upgrade for non-BoLD rollup is possible",
            "description": "1. **Description:** The Orbit action allows an invalid upgrade path from version 3.x.x to 2.2.3, which constitutes a downgrade rather than a valid upgrade. This could lead to undefined behavior or loss of expected functionality in the upgraded contracts.\n2. **Cause:** The vulnerability arises because the upgrade logic checks for versions below 2.x.x using the presence of the `nativeTokenDecimals` function, but it does not verify that the current version is not already above 2.2.3 (e.g., 3.x.x). Since the function exists in later versions, the check passes even when downgrading.\n3. **Exploitation:** An attacker or misconfigured user could invoke the upgrade action on a contract already at version 3.x.x, causing it to be downgraded to 2.2.3. This would revert any improvements or fixes present in the newer version.\n4. **Impact:** The impact includes potential disruption of contract functionality, incorrect state transitions, and possible financial loss if critical logic changes between versions are reverted. While not directly leading to fund theft, it introduces operational risk and undefined behavior.\n",
            "severity": "Informational",
            "location": [
                "NitroContracts2Point1Point3UpgradeAction.sol"
            ],
            "files": [
                "f4f878e101e54170080532ad3ba6e70dab56a2b9/orbit-actions/contracts/parent-chain/contract-upgrades/NitroContracts2Point1Point3UpgradeAction.sol"
            ]
        }
    ]
}