{
    "path": "dataset-curated/reports/Zellic/Odos Router V3 - Zellic Audit Report.pdf",
    "project_info": {
        "url": [
            "https://github.com/odos-xyz/odos-router-v3"
        ],
        "commit_id": [
            "f90fd6230e7dbdc2a71c4e12df57b2dfdeacb7ed"
        ],
        "address": [],
        "chain": "evm",
        "compiler_version": "n/a",
        "audit_date": "2024-11-05",
        "project_path": {
            "odos-router-v3": "dataset-curated/contracts/Odos Router V3 - Zellic Audit Report.pdf-source"
        }
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-693"
                ],
                "2": [
                    "CWE-807"
                ]
            },
            "title": "User-Controlled Referral Fee and Recipient",
            "description": "1. **Description:** The OdosRouterV3 contract now allows users to directly specify the referral fee and feeRecipient via the swapReferralInfo input parameter in multiple swap functions, removing reliance on an on-chain registry.\n\n2. **Cause:** The referral system was moved off-chain, and the contract no longer enforces referral data immutability or authorization. Instead, users can pass arbitrary values for fee and feeRecipient during swaps.\n\n3. **Exploitation:** A malicious actor could set a high fee and direct it to their own address, potentially misleading analytics or attempting to manipulate fee distribution systems, though actual fund diversion is limited by the contract's require checks.\n\n4. **Impact:** While the contract enforces that the feeRecipient is not zero and the fee is bounded (\u22642% of FEE_DENOM), the ability for any user to set arbitrary referral data may undermine the integrity of referral tracking and fee attribution, especially in systems relying on trust in referral sources.\n",
            "severity": "Low",
            "location": [
                "OdosRouterV3.sol::swapMulti",
                "OdosRouterV3.sol::_swap",
                "OdosRouterV3.sol::_swapMulti"
            ],
            "files": [
                "odos-router-v3/contracts/OdosRouterV3.sol"
            ]
        }
    ]
}