{
    "path": "dataset-curated/reports/Cantina/cantina_uniswap_nov2025.pdf",
    "project_info": {
        "url": [
            "https://github.com/Uniswap/protocol-fees"
        ],
        "commit_id": [
            "a35efd21"
        ],
        "address": [],
        "chain": "evm",
        "compiler_version": "n/a",
        "audit_date": "2025-11-16",
        "project_path": {
            "protocol-fees": "dataset-curated/contracts/cantina_uniswap_nov2025.pdf-source"
        }
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ],
                "3": [
                    "CWE-1288"
                ]
            },
            "title": "Unchecked Fee Parameter in setDefaultFeeByFeeTier() Causes Downstream Pool Reverts and Protocol Fee Update DoS",
            "description": "1. **Description:** The `setDefaultFeeByFeeTier()` function in `V3FeeAdapter.sol` accepts an unvalidated `uint8` value for `defaultFeeValue`, which is later decomposed into two 4-bit components used to set protocol fees in Uniswap V3 pools. If the value leads to invalid fee components, it causes downstream pool reverts.\n2. **Cause:** The function lacks input validation to ensure the decomposed fee values (from `defaultFeeValue % 16` and `defaultFeeValue >> 4`) comply with the Uniswap V3 pool's requirement that each must be 0 or in the range [4,10].\n3. **Exploitation:** A malicious or mistaken caller could set an invalid `defaultFeeValue` (e.g., 255), causing all subsequent `_setProtocolFee()` calls for that fee tier to revert.\n4. **Impact:** This results in a denial of service for protocol fee updates on affected fee tiers until the value is corrected, potentially delaying critical fee adjustments.\n",
            "severity": "Low",
            "location": [
                "V3FeeAdapter.sol::setDefaultFeeByFeeTier#98"
            ],
            "files": [
                "protocol-fees/src/feeAdapters/V3FeeAdapter.sol"
            ]
        },
        {
            "id": 1,
            "category": {
                "1": [
                    "CWE-664"
                ],
                "2": [
                    "CWE-404"
                ],
                "3": [
                    "CWE-772"
                ]
            },
            "title": "Pools of assets with very low volume could make fees sit in the contract indefinitely unless the threshold is updated",
            "description": "1. **Description:** The `release` function in `ExchangeReleaser.sol` requires searchers to burn a threshold amount of UNI to claim fee tokens. For pools with very low trading volume, the value of the accumulated fees may be less than the required UNI burn, making it economically unviable to claim.\n2. **Cause:** The fixed threshold and limited `MAX_RELEASE_LENGTH` (20) create a situation where low-value tokens remain unclaimed indefinitely.\n3. **Exploitation:** No active exploitation is required; this is a passive economic disincentive.\n4. **Impact:** Tokens with minimal value may remain trapped in the contract forever, reducing capital efficiency and potentially requiring future governance intervention to resolve.\n",
            "severity": "Low",
            "location": [
                "ExchangeReleaser.sol::release#39"
            ],
            "files": [
                "protocol-fees/src/releasers/ExchangeReleaser.sol"
            ]
        },
        {
            "id": 2,
            "category": {
                "1": [
                    "CWE-710"
                ]
            },
            "title": "Unnecessary Type Casting in collect() Function",
            "description": "1. **Description:** The `collect()` function in `V3FeeAdapter.sol` unnecessarily casts the return values of `collectProtocol()` from `uint128` to `uint256` and back to `uint128`, increasing gas consumption.\n2. **Cause:** Poor type handling in variable declaration, where `uint256` is used instead of the correct `uint128` type matching the return values.\n3. **Exploitation:** This is not exploitable in a malicious sense but represents inefficient code.\n4. **Impact:** Increased gas costs for users calling the `collect()` function, leading to higher transaction fees and reduced efficiency.\n",
            "severity": "Informational",
            "location": [
                "V3FeeAdapter.sol::collect#83-87"
            ],
            "files": [
                "protocol-fees/src/feeAdapters/V3FeeAdapter.sol"
            ]
        },
        {
            "id": 3,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1059"
                ]
            },
            "title": "Missing Docstrings",
            "description": "1. **Description:** Multiple contracts and functions across the codebase lack proper NatSpec documentation (docstrings), including `ArrayLib.sol`, `Deployer.sol`, `Nonce.sol`, and `V3FeeAdapter.sol`.\n2. **Cause:** Incomplete or missing documentation during development.\n3. **Exploitation:** This cannot be exploited maliciously but reduces code readability and maintainability.\n4. **Impact:** Makes it harder for developers, auditors, and users to understand the intended behavior of functions and contracts, increasing the risk of future errors or misinterpretations.\n",
            "severity": "Informational",
            "location": [
                "Nonce.sol#6",
                "Deployer.sol#13",
                "V3FeeAdapter.sol#71",
                "ArrayLib.sol#4"
            ],
            "files": [
                "protocol-fees/src/libraries/ArrayLib.sol",
                "protocol-fees/src/Deployer.sol",
                "protocol-fees/src/base/Nonce.sol",
                "protocol-fees/src/feeAdapters/V3FeeAdapter.sol"
            ]
        },
        {
            "id": 4,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ],
                "3": [
                    "CWE-1289"
                ]
            },
            "title": "Missing address(0) Validation Across Multiple Critical Functions",
            "description": "1. **Description:** Several critical functions across the codebase do not validate that address parameters are not `address(0)`, including `setReleaser`, `updateRecipient`, `release`, `setFactoryOwner`, `setThresholdSetter`, and `setFeeSetter`.\n2. **Cause:** Lack of input validation for address parameters in ownership and configuration functions.\n3. **Exploitation:** A mistaken or malicious caller could set a critical address (e.g., recipient, releaser, owner) to `address(0)`, leading to loss of funds or functionality.\n4. **Impact:** Could result in locked funds (e.g., tokens sent to `address(0)`), loss of access to functionality, or permanent misconfiguration of critical components.\n",
            "severity": "Informational",
            "location": [
                "ResourceManager.sol::setThresholdSetter#40",
                "V3FeeAdapter.sol::setFactoryOwner#71",
                "V3FeeAdapter.sol::setFeeSetter#104",
                "ExchangeReleaser.sol::release#39",
                "TokenJar.sol::setReleaser#40",
                "UNIVesting.sol::updateRecipient#73"
            ],
            "files": [
                "protocol-fees/src/base/ResourceManager.sol"
            ]
        },
        {
            "id": 5,
            "category": {
                "1": [
                    "CWE-682"
                ]
            },
            "title": "Residual Tokens May Remain Unclaimed When Vesting Amount Is Updated",
            "description": "1. **Description:** The `updateVestingAmount()` function in `UNIVesting.sol` allows changing the quarterly vesting amount only when no quarters are claimable, but doing so can leave residual tokens unclaimable due to misalignment with the new amount.\n2. **Cause:** The vesting logic does not account for leftover tokens when the vesting amount is reduced after partial withdrawals.\n3. **Exploitation:** No active exploitation, but a change in vesting amount can inadvertently trap tokens.\n4. **Impact:** Recipients may be unable to claim all vested tokens without manual intervention or further governance action, leading to potential loss of funds.\n",
            "severity": "Informational",
            "location": [
                "UNIVesting.sol::updateVestingAmount#98"
            ],
            "files": [
                "protocol-fees/src/UNIVesting.sol"
            ]
        },
        {
            "id": 6,
            "category": {
                "1": [
                    "CWE-664"
                ],
                "2": [
                    "CWE-221"
                ],
                "3": [
                    "CWE-223"
                ],
                "4": [
                    "CWE-778"
                ]
            },
            "title": "Missing event emission for key storage changes",
            "description": "1. **Description:** Key state-changing functions such as `setMerkleRoot`, `setDefaultFeeByFeeTier`, `setReleaser`, and `setThreshold` do not emit events, making it difficult to track changes off-chain.\n2. **Cause:** Lack of event emission in state-modifying functions.\n3. **Exploitation:** This cannot be exploited directly but reduces transparency.\n4. **Impact:** External systems and users cannot reliably monitor critical configuration changes, potentially leading to delayed responses or incorrect assumptions about contract state.\n",
            "severity": "Informational",
            "location": [
                "V3FeeAdapter.sol::setMerkleRoot#94",
                "V3FeeAdapter.sol::setFeeSetter#100",
                "V3FeeAdapter.sol::setDefaultFeeByFeeTier#105",
                "TokenJar.sol::setReleaser#41"
            ],
            "files": [
                "protocol-fees/src/feeAdapters/V3FeeAdapter.sol"
            ]
        },
        {
            "id": 7,
            "category": {
                "1": [
                    "CWE-284"
                ],
                "2": [
                    "CWE-282"
                ],
                "3": [
                    "CWE-283"
                ]
            },
            "title": "Single-step ownership transfer",
            "description": "1. **Description:** Contracts such as `V3FeeAdapter`, `TokenJar`, `UNIVesting`, and `ResourceManager` use a single-step ownership transfer, where setting a new owner takes effect immediately without confirmation.\n2. **Cause:** Use of basic `Ownable` pattern instead of a two-step ownership transfer.\n3. **Exploitation:** A typo or mistake in the new owner address results in permanent loss of control, with no way to revert.\n4. **Impact:** High risk of accidental ownership loss, especially in governance-controlled contracts where recovery may require complex coordination.\n",
            "severity": "Informational",
            "location": [
                "V3FeeAdapter.sol#4",
                "V3FeeAdapter.sol#21",
                "TokenJar.sol#13",
                "UNIVesting.sol#17"
            ],
            "files": [
                "protocol-fees/src/V3FeeAdapter.sol",
                "protocol-fees/src/TokenJar.sol",
                "protocol-fees/src/UNIVesting.sol",
                "protocol-fees/src/base/ResourceManager.sol"
            ]
        },
        {
            "id": 8,
            "category": {
                "1": [
                    "CWE-664"
                ],
                "2": [
                    "CWE-665"
                ],
                "3": [
                    "CWE-1419"
                ],
                "4": [
                    "CWE-1188"
                ],
                "5": [
                    "CWE-453"
                ]
            },
            "title": "Unconfigured default fee values for fee tiers",
            "description": "1. **Description:** The `Deployer.sol` contract sets up fee tiers in `V3FeeAdapter` but fails to initialize default fee values, leaving protocol fees disabled by default.\n2. **Cause:** Omission in the deployment logic to configure default fees before transferring ownership to the DAO.\n3. **Exploitation:** No active exploitation, but the protocol starts in a suboptimal state.\n4. **Impact:** Protocol fees remain at 0% until a governance proposal is passed, delaying revenue generation and requiring unnecessary governance overhead.\n",
            "severity": "Informational",
            "location": [
                "Deployer.sol#60"
            ],
            "files": [
                "protocol-fees/src/Deployer.sol"
            ]
        }
    ]
}