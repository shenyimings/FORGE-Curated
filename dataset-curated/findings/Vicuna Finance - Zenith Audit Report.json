{
    "path": "dataset-curated/reports/Zenith/Vicuna Finance - Zenith Audit Report.pdf",
    "project_info": {
        "url": [
            "https://github.com/VicunaFinance-com/Vicuna-core-bl"
        ],
        "commit_id": [
            "782f51917056a53a2c228701058a6c3fb233684a"
        ],
        "address": [
            "0xF224CB039F2B5909197c019b1972E62d7fdCdA0f"
        ],
        "chain": "evm/sonic",
        "compiler_version": "n/a",
        "audit_date": "2025-02-28",
        "project_path": {
            "Vicuna-core-bl": "dataset-curated/contracts/Vicuna Finance - Zenith Audit Report.pdf-source"
        }
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1076"
                ]
            },
            "title": "Misleading token name implementation",
            "description": "The ERC20 token contract at address 0xF224CB039F2B5909197c019b1972E62d7fdCdA0f uses a generic name \"ERC20\" instead of a descriptive name like \"Vicuna Sonic USDC.E\". This is misleading because \"ERC20\" refers to the token standard, not a specific token, which can confuse users when viewing the token in wallets or explorers. The cause is a poor implementation choice during token deployment. While this does not lead to direct financial loss, it can result in user confusion or potential phishing risks if users mistake it for a different token. The impact is low, limited to user experience and brand clarity.\n",
            "severity": "Low",
            "location": [
                "0xF224CB039F2B5909197c019b1972E62d7fdCdA0f"
            ],
            "files": [
                "Vicuna-core-bl/contracts/mocks/tokens/MintableERC20.sol"
            ]
        },
        {
            "id": 1,
            "category": {
                "1": [
                    "CWE-664"
                ],
                "2": [
                    "CWE-666"
                ]
            },
            "title": "Missing state and interest rate updates in setReserveInterestRateStrategyAddress",
            "description": "The `setReserveInterestRateStrategyAddress` function in Pool.sol fails to update the reserve's state and interest rates after changing the interest rate strategy address. This omission can lead to inconsistent reserve state and incorrect interest rate calculations, as the new strategy is not immediately applied. The root cause is the absence of calls to `reserve.updateState` and `reserve.updateInterestRates` within the function. An attacker could potentially exploit timing windows where outdated rates are used, leading to incorrect yield calculations or unfair advantages in borrowing/lending. The impact is low, as it affects accuracy rather than leading to direct fund loss.\n",
            "severity": "Low",
            "location": [
                "Pool.sol#L628"
            ],
            "files": [
                "Vicuna-core-bl/contracts/protocol/pool/Pool.sol"
            ]
        },
        {
            "id": 2,
            "category": {
                "1": [
                    "CWE-664"
                ],
                "2": [
                    "CWE-221"
                ],
                "3": [
                    "CWE-223"
                ]
            },
            "title": "Implementation of consistent methodology for setting supply and borrow caps",
            "description": "Many assets in the protocol have supply and borrow caps set to zero, indicating a lack of proper risk parameter configuration. This absence of defined caps exposes the protocol to risks such as price manipulation, over-leveraging, and potential insolvency during market volatility. The root cause is the lack of a standardized, transparent methodology for setting these critical risk parameters. While no immediate exploit is evident, an attacker could target under-capped or uncapped assets to drain liquidity or manipulate prices. The impact is low due to current usage levels, but the risk could escalate as the protocol grows.\n",
            "severity": "Low",
            "location": [
                "0x4e1dee6eb2f48bcf26a7dca815b4b91e149bf21c791d2dbc8b5fc42e67277599"
            ],
            "files": []
        },
        {
            "id": 3,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-755"
                ],
                "3": [
                    "CWE-636"
                ]
            },
            "title": "API3 and Pegged Oracles revert on invalid prices, potentially blocking the fallback oracle if configured",
            "description": "The PeggedOracle and API3 oracle implementations revert when invalid prices are detected, instead of returning a zero value. This behavior prevents the fallback oracle from being triggered in case of failure, as reverts halt execution before the fallback logic can be reached. The root cause is the use of `revert` statements in price-fetching functions rather than gracefully returning zero. An attacker could manipulate or disrupt primary price feeds, causing the entire price retrieval mechanism to fail without fallback, potentially leading to incorrect valuations or halted operations. The impact is low, as it affects availability rather than leading to direct fund loss, but it undermines the resilience of the oracle system.\n",
            "severity": "Low",
            "location": [
                "Oracles"
            ],
            "files": [
                "Vicuna-core-bl/contracts/misc/AaveOracle.sol"
            ]
        },
        {
            "id": 4,
            "category": {
                "1": [
                    "CWE-693"
                ]
            },
            "title": "Lack of initial deposit in the new market listing script",
            "description": "The market listing script does not include an initial deposit when creating a new market, making it vulnerable to the \"empty market exploit\" where a malicious actor can deposit a minimal amount and manipulate market conditions. The root cause is the omission of a small initial deposit in the deployment script. An attacker could exploit this by front-running the first legitimate deposit, potentially influencing interest rates or enabling unfair liquidations. The impact is low, as the risk is mitigated once real liquidity is added, but it poses a short-term risk during market initialization.\n",
            "severity": "Low",
            "location": [
                "deploy/02_market"
            ],
            "files": []
        },
        {
            "id": 5,
            "category": {
                "1": [
                    "CWE-284"
                ],
                "2": [
                    "CWE-269"
                ],
                "3": [
                    "CWE-266"
                ]
            },
            "title": "Upgrade privileged roles to multi-sig after the deployment",
            "description": "Privileged roles such as market owner, emergency admin, and pool admin are currently assigned to a single deployer address, creating a single point of failure. This centralization increases the risk of unauthorized access or misuse if the private key is compromised. The root cause is the use of a single-signature wallet for critical administrative functions. An attacker gaining access to the deployer key could alter protocol parameters, drain funds, or disable safety mechanisms. The impact is informational, as it highlights a governance risk rather than an immediate exploit, but it is critical for long-term security.\n",
            "severity": "Informational",
            "location": [
                "0xbE0B2230B842be6A37188038a58755534dC9E999"
            ],
            "files": [
                "Vicuna-core-bl/helpers/types.ts"
            ]
        },
        {
            "id": 6,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1076"
                ]
            },
            "title": "Unverified contracts on SonicScan",
            "description": "Several contracts, including those at 0xDdE41Eb19346D423b4Cc8e3917c3000cFBE490Fa and 0xc9d2f7fd8f7025a9696d1ec9a5b2318602c431df, are not verified on SonicScan. This lack of verification reduces transparency and prevents external parties from auditing the on-chain code. The root cause is the failure to submit source code for verification after deployment. While this does not introduce a direct security vulnerability, it undermines trust and makes it harder to detect malicious behavior or discrepancies. The impact is informational, as it affects transparency rather than functionality.\n",
            "severity": "Informational",
            "location": [
                "0xDdE41Eb19346D423b4Cc8e3917c3000cFBE490Fa",
                "0xc9d2f7fd8f7025a9696d1ec9a5b2318602c431df"
            ],
            "files": []
        },
        {
            "id": 7,
            "category": {
                "1": [
                    "CWE-435"
                ],
                "2": [
                    "CWE-436"
                ],
                "3": [
                    "CWE-437"
                ]
            },
            "title": "Pyth Price Oracle might break some assumptions",
            "description": "The Pyth oracle allows permissionless price updates as long as the timestamp increases, enabling a user to update the price multiple times within a single transaction. This behavior can be exploited to open a position and then immediately update the price to make it liquidatable, all within the same transaction. The root cause is the design of Pyth as a pull-based oracle with unrestricted updates. This breaks assumptions about price stability within a block and could enable sandwich attacks or forced liquidations. The impact is informational, as it highlights a design consideration rather than a direct bug, but it could lead to user losses if not properly mitigated.\n",
            "severity": "Informational",
            "location": [
                "PythOracle"
            ],
            "files": [
                "Vicuna-core-bl/helpers/types.ts"
            ]
        }
    ]
}