{
    "path": "dataset-curated/reports/ChainSecurity/ChainSecurity_Enzyme_SuluExtensionsXXIV_Audit.pdf",
    "project_info": {
        "url": [
            "https://github.com/enzymefinance/protocol"
        ],
        "commit_id": [
            "1080e9554108a5e8188fa8f0fd5dae806592c786",
            "e70c26efb5f8c6139cc7b0e913c22dc6750abaa7"
        ],
        "address": [],
        "chain": "evm",
        "compiler_version": "n/a",
        "audit_date": "2025-05-08",
        "project_path": {
            "protocol": "dataset-curated/contracts/ChainSecurity_Enzyme_SuluExtensionsXXIV_Audit.pdf-source"
        }
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-682"
                ]
            },
            "title": "Unpriced Left Tickets",
            "description": "1. **Description:** The vulnerability involves the incorrect pricing of exit requests in the Stakewise V3 external position, where partially withdrawable exit requests could leave unpriced \"left tickets\" in the system. This leads to an undervaluation of the position when calculating managed assets.\n2. **Cause:** The root cause is that the `getManagedAssets()` function only accounts for the claimed assets from exit requests using `calculateExitedAssets()`, but does not consider the remaining unclaimed or pending exit shares (leftTickets), which should also contribute to the position value.\n3. **Exploitation:** An attacker could potentially manipulate or exploit the valuation discrepancy during asset reporting or fund withdrawal, especially in scenarios where partial exits are common, leading to incorrect net asset value calculations.\n4. **Impact:** The impact includes inaccurate valuation of the fund's managed assets, which could affect investor decisions, rebalancing operations, or profit calculations, ultimately undermining trust in the system's financial accuracy.\n",
            "severity": "Low",
            "location": [
                "StakeWiseV3StakingPositionLib.sol::getManagedAssets"
            ],
            "files": [
                "protocol/contracts/release/extensions/external-position-manager/external-positions/stakewise-v3-staking/StakeWiseV3StakingPositionLib.sol"
            ]
        }
    ]
}