{
    "path": "dataset-curated/reports/TrailofBits/2025-08-starkware-starkex-diff-review-securityreview.pdf",
    "project_info": {
        "url": [
            "https://github.com/starkware-libs/starkex-contracts"
        ],
        "commit_id": [
            "f3b2506",
            "210bd5f"
        ],
        "address": null,
        "chain": "evm",
        "compiler_version": "n/a",
        "audit_date": "2025-07-28",
        "project_path": {
            "starkex-contracts": "dataset-curated/contracts/2025-08-starkware-starkex-diff-review-securityreview.pdf-source"
        }
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-435"
                ],
                "2": [
                    "CWE-439"
                ]
            },
            "title": "Change of program output offsets breaks compatibility with old programs",
            "description": "1. **Description:** The structure of data and offsets in the program output was modified by introducing a new field for the data availability mode at offset 1, which shifts all subsequent fields by one position. This change renders old program outputs incompatible with the new contract version.\n2. **Cause:** The root cause is the insertion of a new field at the beginning of the data structure instead of appending it, which breaks backward compatibility. As a result, previously valid program outputs are now misinterpreted\u2014specifically, the old N_ASSET_CONFIGS field is now read as DATA_AVAILABILITY_MODE.\n3. **Exploitation:** An attacker or malfunctioning operator could submit legacy program outputs that are now incorrectly parsed, potentially leading to state corruption or failed state updates if the system attempts to process outdated formats.\n4. **Impact:** The primary impact is a breaking change that prevents interoperability with older versions of the system, requiring all operators to upgrade and strictly adhere to the new output format. This could lead to operational failures or delays during the transition period.\n",
            "severity": "Informational",
            "location": [
                "scalable-dex/contracts/src/perpetual/ProgramOutputOffsets.sol"
            ],
            "files": [
                "starkex-contracts/scalable-dex/contracts/src/perpetual/ProgramOutputOffsets.sol"
            ]
        }
    ]
}