{
    "path": "dataset-curated/reports/OpenZeppelin/Fireblocks Gasless Contracts Audit.md",
    "project_info": {
        "url": [
            "https://github.com/fireblocks/fireblocks-smart-contracts"
        ],
        "commit_id": [
            "cf1bb85ea84cd9ce9b509e285e835b8eb459ddd8"
        ],
        "address": [],
        "chain": "evm",
        "compiler_version": "n/a",
        "audit_date": "2024-12-02",
        "project_path": {
            "fireblocks-smart-contracts": "dataset-curated/contracts/Fireblocks Gasless Contracts Audit.md-source"
        }
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1076"
                ]
            },
            "title": "Limitation in Asset Transfer Capabilities During Contract Deployment in `GaslessFactory`",
            "description": "The `deploy` and `deployDeterministic` functions in the `GaslessFactory` contract are not marked as `payable`, which prevents users from sending native assets during contract deployment. This limitation stems from the lack of payable modifier on these functions, restricting the ability to initialize newly deployed contracts with a native asset balance. An attacker or user cannot exploit this directly, but it limits functionality for legitimate use cases where a contract must hold native assets upon creation. The impact is reduced flexibility and utility of the `GaslessFactory`, especially for contracts that require initial funding upon deployment.\n",
            "severity": "Low",
            "location": [
                "GaslessFactory.sol::deploy#108-138",
                "GaslessFactory.sol::deployDeterministic#161-177",
                "GaslessFactory.sol::postConfig"
            ],
            "files": [
                "fireblocks-smart-contracts/contracts/gasless-contracts/GaslessFactory.sol"
            ]
        },
        {
            "id": 1,
            "category": {
                "1": [
                    "CWE-691"
                ],
                "2": [
                    "CWE-670"
                ]
            },
            "title": "Premature Event Emission in GaslessFactory's `_execute` Function",
            "description": "The `_execute` function in the `GaslessFactory` contract emits the `FunctionExecuted` event before the actual delegated call is executed. This incorrect ordering causes the event to log a result of zero regardless of the actual outcome of the function call, leading to inaccurate event logs. The root cause is improper sequence of operations within the function. Off-chain services relying on these events may be misled into believing a function call succeeded or failed incorrectly, which undermines trust and transparency. The impact is potential misinterpretation of transaction results by external systems, though it does not directly lead to fund loss or control overreach.\n",
            "severity": "Low",
            "location": [
                "GaslessFactory.sol::_execute#220-227"
            ],
            "files": [
                "fireblocks-smart-contracts/contracts/gasless-contracts/GaslessFactory.sol"
            ]
        }
    ]
}