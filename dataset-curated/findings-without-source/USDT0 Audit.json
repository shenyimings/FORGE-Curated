{
    "path": "dataset-curated/reports/OpenZeppelin/USDT0 Audit.md",
    "project_info": {
        "url": [
            "https://github.com/Everdawn-Labs/usdt0-tether-contracts-hardhat"
        ],
        "commit_id": [
            "01cdf1d74c1bd4d9a664de4755ac5112f2a9988c"
        ],
        "address": [],
        "chain": "arbitrum",
        "compiler_version": "n/a",
        "audit_date": "2025-01-21",
        "project_path": "n/a"
    },
    "findings": [
        {
            "id": 0,
            "category": {},
            "title": "Use `calldata` Instead of `memory`",
            "description": "The `signature` parameter in the `permit`, `transferWithAuthorization`, and `receiveWithAuthorization` functions in `ArbitrumExtension.sol` and `TetherTokenV2.sol` is declared with `memory` data location, despite being parameters of `external` functions. This causes unnecessary gas costs because `memory` copies the data, whereas `calldata` is a read-only, cheaper alternative for external function arguments. The root cause is suboptimal parameter data location choice. An attacker cannot directly exploit this, but users are forced to pay higher gas fees when interacting with these functions. The impact is increased transaction costs for all users, reducing economic efficiency and user experience.\n",
            "severity": null,
            "location": [
                "ArbitrumExtension.sol::permit#172",
                "ArbitrumExtension.sol::transferWithAuthorization#278",
                "ArbitrumExtension.sol::receiveWithAuthorization#397",
                "TetherTokenV2.sol::permit#",
                "TetherTokenV2.sol::transferWithAuthorization#",
                "TetherTokenV2.sol::receiveWithAuthorization#"
            ],
            "files": []
        },
        {
            "id": 1,
            "category": {},
            "title": "`isValidSignatureNow` Reverts on Invalid ECDSA Signatures",
            "description": "The `isValidSignatureNow` function in the `SignatureChecker` library reverts when an invalid ECDSA signature is provided, unlike the OpenZeppelin reference implementation which returns `false` without reverting. This deviation causes inconsistent error handling, where functions like `_permit` in `TetherTokenV2` may throw low-level ECDSA errors (e.g., \"ECRecover: invalid signature length\") instead of application-level errors (e.g., \"EIP2612: invalid signature\"). The root cause is a modification to the standard signature validation logic. This can lead to confusing error messages for frontends and dApps, potentially masking the true cause of transaction failures. The impact is degraded user experience and debugging complexity, which could delay incident response in production environments.\n",
            "severity": null,
            "location": [
                "SignatureChecker.sol::isValidSignatureNow#42",
                "ECRecover.sol::recover#40-85",
                "TetherTokenV2.sol::_permit#70-73"
            ],
            "files": []
        },
        {
            "id": 2,
            "category": {},
            "title": "Inconsistency on Transfers to Blocked Recipients",
            "description": "The `WithBlockedList` contract allows blocked accounts to receive tokens via direct transfers but prevents them from executing `receiveWithAuthorization`, even if authorized by the sender. This creates an inconsistent user experience where a blocked recipient can receive tokens in some ways but not others. The root cause is the presence of the `onlyNotBlocked` modifier on `receiveWithAuthorization`, which blocks execution even for self-receiving operations. An attacker could exploit this by authorizing a transfer to a blocked account and then observing the failure, potentially leading to denial-of-service for authorized but blocked users. The impact is functional inconsistency and potential confusion in gasless transfer mechanisms.\n",
            "severity": null,
            "location": [
                "WithBlockedList.sol::onlyNotBlocked#24-27",
                "TetherTokenV2.sol::receiveWithAuthorization#296",
                "TetherToken.sol#47-52",
                "TetherToken.sol#63"
            ],
            "files": []
        },
        {
            "id": 3,
            "category": {},
            "title": "Multiple Optimizable State Reads",
            "description": "Several storage variables such as `_newName` and `_newSymbol` in `ArbitrumExtension.sol` and `OFTExtension.sol` are read multiple times from storage without being cached in memory. Each `SLOAD` operation is expensive in terms of gas, and repeated reads of the same variable can be optimized by loading the value into a local memory variable once. The root cause is inefficient code structure that does not cache frequently accessed state variables. While not directly exploitable, this increases gas costs for users during function execution. The impact is higher transaction fees and reduced efficiency, especially in functions that read the same storage variable multiple times.\n",
            "severity": null,
            "location": [
                "ArbitrumExtension.sol::_newName#521",
                "ArbitrumExtension.sol::_newSymbol#529",
                "OFTExtension.sol::_newName#70",
                "OFTExtension.sol::_newSymbol#78"
            ],
            "files": []
        },
        {
            "id": 4,
            "category": {},
            "title": "File and Contract Names Mismatch",
            "description": "The file `OFTExtension.sol` contains a contract named `TetherTokenOFTExtension`, creating a mismatch between the filename and the contract name. This can lead to confusion for developers and auditors navigating the codebase, increasing the risk of human error during development or review. The root cause is a deviation from standard naming conventions. While not a direct security vulnerability, it reduces code clarity and maintainability. The impact is increased cognitive load and potential for mistakes when integrating or modifying the contract.\n",
            "severity": null,
            "location": [
                "OFTExtension.sol"
            ],
            "files": []
        },
        {
            "id": 5,
            "category": {},
            "title": "Multiple Functions With Incorrect Order of Modifiers",
            "description": "Functions such as `_EIP712NameHash` in `ArbitrumExtension.sol` and `OFTExtension.sol`, and `domainSeparator` in `EIP3009.sol`, declare modifiers in an order that deviates from the Solidity Style Guide (e.g., `view virtual` instead of `virtual view`). This inconsistency reduces code readability and may lead to confusion about function behavior. The root cause is non-compliance with established style conventions. While not exploitable, it reflects a lack of code standardization, which can hinder auditability and long-term maintenance. The impact is reduced code quality and developer experience.\n",
            "severity": null,
            "location": [
                "ArbitrumExtension.sol::_EIP712NameHash#503-505",
                "EIP3009.sol::domainSeparator#52",
                "OFTExtension.sol::_EIP712NameHash#56-58"
            ],
            "files": []
        },
        {
            "id": 6,
            "category": {},
            "title": "Inconsistent Order Within Contracts",
            "description": "Multiple contracts including `TetherTokenV2Arbitrum`, `ArbitrumExtensionV2`, `TetherTokenOFTExtension`, and `TetherTokenV2` do not follow the recommended order of function layout as per the Solidity Style Guide. Functions are not grouped logically (e.g., constructors, external functions, internal functions, etc.), which reduces code readability. The root cause is inconsistent code organization. This does not introduce direct security risks but makes the code harder to audit and maintain. The impact is reduced clarity and increased risk of oversight during future development or security reviews.\n",
            "severity": null,
            "location": [
                "ArbitrumExtension.sol::TetherTokenV2Arbitrum",
                "ArbitrumExtension.sol::ArbitrumExtensionV2",
                "OFTExtension.sol::TetherTokenOFTExtension",
                "TetherTokenV2.sol::TetherTokenV2"
            ],
            "files": []
        },
        {
            "id": 7,
            "category": {},
            "title": "Lack of Indexed Event Parameters",
            "description": "The `LogUpdateNameAndSymbol` event in both `ArbitrumExtension.sol` and `OFTExtension.sol` does not have indexed parameters, making it difficult for off-chain services to efficiently filter and query event data. The root cause is omission of the `indexed` keyword for event fields. This increases the cost and complexity of monitoring contract activity. The impact is reduced observability and higher operational costs for indexers and monitoring tools, potentially delaying detection of critical state changes.\n",
            "severity": null,
            "location": [
                "ArbitrumExtension.sol::LogUpdateNameAndSymbol#427",
                "OFTExtension.sol::LogUpdateNameAndSymbol#23"
            ],
            "files": []
        },
        {
            "id": 8,
            "category": {},
            "title": "Lack of Security Contact",
            "description": "The `ArbitrumExtensionV2` and `TetherTokenOFTExtension` contracts do not include a `@custom:security-contact` NatSpec comment, making it difficult for security researchers to report vulnerabilities. The root cause is missing documentation for responsible disclosure. This increases the risk that vulnerabilities will go unreported or be disclosed publicly without coordination. The impact is reduced security posture due to lack of a clear reporting channel, potentially leading to unpatched vulnerabilities.\n",
            "severity": null,
            "location": [
                "ArbitrumExtension.sol::ArbitrumExtensionV2",
                "OFTExtension.sol::TetherTokenOFTExtension"
            ],
            "files": []
        },
        {
            "id": 9,
            "category": {},
            "title": "Non-explicit Imports Are Used",
            "description": "The contracts use global imports (e.g., `import \"../Tether/TetherToken.sol\";`) instead of named imports (e.g., `import {TetherToken} from \"../Tether/TetherToken.sol\";`). This can lead to naming conflicts and reduce code clarity, especially in files with multiple contracts. The root cause is use of deprecated import syntax. This increases the risk of shadowing or confusion when multiple symbols are imported. The impact is reduced code maintainability and potential for subtle bugs during refactoring or upgrades.\n",
            "severity": null,
            "location": [
                "ArbitrumExtension.sol#5",
                "ArbitrumExtension.sol#6",
                "ArbitrumExtension.sol#7",
                "OFTExtension.sol#5"
            ],
            "files": []
        },
        {
            "id": 10,
            "category": {},
            "title": "Duplicated Code",
            "description": "The `TetherTokenV2Arbitrum` contract in `ArbitrumExtension.sol` contains identical code to `TetherTokenV2` in `TetherTokenV2.sol`, leading to code duplication. The root cause is lack of inheritance or modularization. This increases maintenance burden and the risk of inconsistent updates. The impact is higher likelihood of bugs if one version is updated and the other is not, reducing code reliability and auditability.\n",
            "severity": null,
            "location": [
                "ArbitrumExtension.sol::TetherTokenV2Arbitrum",
                "TetherTokenV2.sol::TetherTokenV2"
            ],
            "files": []
        },
        {
            "id": 11,
            "category": {},
            "title": "Inconsistency Between `bridgeMint` and `bridgeBurn`",
            "description": "In `ArbitrumExtensionV2`, the `bridgeMint` function reverts with `NotImplemented`, while `bridgeBurn` has an empty body and does not revert, despite both being unused. This inconsistency can confuse developers about intended behavior. The root cause is asymmetric handling of placeholder functions. Although the team noted both will be restricted to the OFT contract post-migration, the current discrepancy may lead to incorrect assumptions. The impact is reduced code clarity and potential for misuse during development or debugging.\n",
            "severity": null,
            "location": [
                "ArbitrumExtension.sol::bridgeMint#469-471",
                "ArbitrumExtension.sol::bridgeBurn#479-480"
            ],
            "files": []
        },
        {
            "id": 12,
            "category": {},
            "title": "Missing Docstrings",
            "description": "Numerous functions, events, state variables, and interfaces across `ArbitrumExtension.sol` and `OFTExtension.sol` lack NatSpec documentation. This includes critical functions like `migrate`, `setOFTContract`, and `updateNameAndSymbol`. The root cause is insufficient inline documentation. This makes it harder for developers and auditors to understand the intended behavior and security assumptions. The impact is increased risk of misinterpretation, leading to integration errors or missed vulnerabilities during review.\n",
            "severity": null,
            "location": [
                "ArbitrumExtension.sol::IArbToken",
                "ArbitrumExtension.sol::ArbitrumExtension",
                "ArbitrumExtension.sol::l1Address",
                "ArbitrumExtension.sol::TetherTokenV2Arbitrum",
                "ArbitrumExtension.sol::IArbL2GatewayRouter",
                "ArbitrumExtension.sol::outboundTransfer",
                "ArbitrumExtension.sol::ArbitrumExtensionV2",
                "ArbitrumExtension.sol::LogSetOFTContract",
                "ArbitrumExtension.sol::Burn",
                "ArbitrumExtension.sol::LogUpdateNameAndSymbol",
                "ArbitrumExtension.sol::USDT0_L1_LOCKBOX",
                "ArbitrumExtension.sol::migrate",
                "ArbitrumExtension.sol::oftContract",
                "ArbitrumExtension.sol::mint",
                "ArbitrumExtension.sol::burn",
                "ArbitrumExtension.sol::setOFTContract",
                "ArbitrumExtension.sol::updateNameAndSymbol",
                "OFTExtension.sol::TetherTokenOFTExtension",
                "OFTExtension.sol::LogSetOFTContract",
                "OFTExtension.sol::Burn",
                "OFTExtension.sol::LogUpdateNameAndSymbol",
                "OFTExtension.sol::oftContract",
                "OFTExtension.sol::mint",
                "OFTExtension.sol::burn",
                "OFTExtension.sol::setOFTContract",
                "OFTExtension.sol::updateNameAndSymbol"
            ],
            "files": []
        },
        {
            "id": 13,
            "category": {},
            "title": "Misleading Documentation of _newName and _newSymbol State Variables",
            "description": "The comments associated with the `_newName` and `_newSymbol` state variables in the `TetherTokenOFTExtension` contract incorrectly state that these variables are unused. \nThe root cause is inaccurate inline documentation that was not updated when the variables were put into use. \nWhile this does not introduce a direct security exploit, a developer relying on the comments might make incorrect assumptions about the code's behavior, potentially leading to integration errors or unsafe modifications. \nThe impact is reduced code clarity, increased risk of human error during maintenance, and potential confusion during future audits or upgrades.\n",
            "severity": "Informational",
            "location": [
                "OFTExtension.sol::_newName#L27-L28",
                "OFTExtension.sol::name#L69-L70",
                "OFTExtension.sol::symbol#L77-L78"
            ],
            "files": []
        },
        {
            "id": 14,
            "category": {},
            "title": "Incorrect Documentation of Transfer Authorization Functions",
            "description": "The documentation for the `_transferWithAuthorizationValidityCheck` and `_receiveWithAuthorizationValidityCheck` functions in the `EIP3009` contract falsely claims that these functions execute a transfer. In reality, they only perform validation and do not carry out the actual transfer operation. \nThis discrepancy stems from imprecise or outdated function-level comments. \nAn attacker could not directly exploit this, but a developer integrating with these functions might assume they perform a full transfer, leading to incomplete or flawed implementations. \nThe impact is a potential logic gap in external systems relying on these functions to perform state changes, resulting in failed operations or unexpected behavior.\n",
            "severity": "Informational",
            "location": [
                "EIP3009.sol::_transferWithAuthorizationValidityCheck#L71",
                "EIP3009.sol::_receiveWithAuthorizationValidityCheck#L110"
            ],
            "files": []
        }
    ]
}