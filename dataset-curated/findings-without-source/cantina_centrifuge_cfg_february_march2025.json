{
    "path": "dataset-curated/reports/Cantina/cantina_centrifuge_cfg_february_march2025.pdf",
    "project_info": {
        "url": [
            "https://github.com/centrifuge/inflation-minter",
            "https://github.com/cantina-forks/cfg-token"
        ],
        "commit_id": [
            "bb8739dc",
            "0b51f63d"
        ],
        "address": [],
        "chain": null,
        "compiler_version": "n/a",
        "audit_date": "2025-02-11",
        "project_path": "n/a"
    },
    "findings": [
        {
            "id": 0,
            "category": {},
            "title": "transferFrom() uses incorrect emit",
            "description": "1. **Description:** The `emit Transfer(receiver, address(0), amount)` in `transferFrom()` simulates burning IOU tokens from the receiver, but logically, the sender should be the one from whom the tokens are burned since the \"I Owe You\" promise is settled from the sender's perspective.\n2. **Cause:** The event emission uses the receiver instead of the sender, which misrepresents the economic action taking place.\n3. **Exploitation:** While not directly exploitable for financial gain, this could mislead off-chain systems or indexers that rely on Transfer events to track token movements and burns.\n4. **Impact:** Incorrect event logging may lead to inaccurate analytics, reporting, or governance decisions based on flawed data.\n",
            "severity": null,
            "location": [
                "IouCfg.sol::transferFrom"
            ],
            "files": []
        },
        {
            "id": 1,
            "category": {},
            "title": "InflationMinter can be optimized",
            "description": "1. **Description:** The `mint()` function in `InflationMinter` is intended for regular (daily) use on mainnet and contains several inefficiencies.\n2. **Cause:** The function uses `uint64` unnecessarily, duplicates a power function (`_rpow`), and recalculates period-based values without optimization.\n3. **Exploitation:** Not directly exploitable, but inefficient code increases gas costs for every call.\n4. **Impact:** Higher gas consumption leads to increased operational costs over time, especially given the expected frequency of calls.\n",
            "severity": null,
            "location": [
                "InflationMinter.sol::mint"
            ],
            "files": []
        },
        {
            "id": 2,
            "category": {},
            "title": "Function decimals() can be optimized",
            "description": "1. **Description:** The `decimals()` function repeatedly queries `legacyCfg.decimals()` instead of caching the value.\n2. **Cause:** Lack of optimization in storing a static value that does not change after deployment.\n3. **Exploitation:** Not exploitable, but results in unnecessary SLOADs on every call.\n4. **Impact:** Increased gas cost for every call to `decimals()`, which could be avoided by storing the value in an immutable variable during construction.\n",
            "severity": null,
            "location": [
                "InflationMinter.sol::decimals"
            ],
            "files": []
        },
        {
            "id": 3,
            "category": {},
            "title": "IERC20 imported from forge-std",
            "description": "1. **Description:** `InflationMinter` imports `IERC20` from `forge-std`, introducing a dependency on a testing/tooling framework.\n2. **Cause:** Using a non-production-standard import path for a core interface.\n3. **Exploitation:** Could lead to deployment or linking issues if `forge-std` is not available or changes in future versions.\n4. **Impact:** Reduced portability and potential build/deployment failures in production environments.\n",
            "severity": null,
            "location": [
                "InflationMinter.sol"
            ],
            "files": []
        },
        {
            "id": 4,
            "category": {},
            "title": "Interface for burn isn't used",
            "description": "1. **Description:** The `burn` function interface is declared but not used within `InflationMinter`.\n2. **Cause:** Dead code that serves no purpose in the current implementation.\n3. **Exploitation:** No direct risk, but increases code size unnecessarily.\n4. **Impact:** Wasted bytecode space and reduced code clarity.\n",
            "severity": null,
            "location": [
                "InflationMinter.sol"
            ],
            "files": []
        },
        {
            "id": 5,
            "category": {},
            "title": "Constructor of InflationMinter doesn't have sanity checks",
            "description": "1. **Description:** The constructor lacks validation for critical parameters like `target`, `token`, `period`, and `rate`.\n2. **Cause:** Missing input validation increases the risk of deploying a broken or insecure instance.\n3. **Exploitation:** A misconfigured deployment could lead to reverts (e.g., division by zero if `period == 0`) or overflows (if `rate` is too high).\n4. **Impact:** Potential for bricking the contract or causing financial loss due to incorrect inflation calculations.\n",
            "severity": null,
            "location": [
                "InflationMinter.sol::constructor"
            ],
            "files": []
        },
        {
            "id": 6,
            "category": {},
            "title": "The interface for function burn() is different than OZ version",
            "description": "1. **Description:** The `burn()` interface in `IouCfg` differs from the OpenZeppelin standard, which may cause integration issues.\n2. **Cause:** Non-standard function signatures (`burn(uint256)` and `burnFrom(address, uint256)`) that do not align with common expectations.\n3. **Exploitation:** Integrators may assume standard behavior and fail to handle allowances correctly.\n4. **Impact:** Integration errors or unexpected behavior when used with third-party systems expecting OZ-compliant ERC20 behavior.\n",
            "severity": null,
            "location": [
                "IouCfg.sol::burn",
                "IouCfg.sol::burnFrom"
            ],
            "files": []
        },
        {
            "id": 7,
            "category": {},
            "title": "IouCfg and InflationMinter use different names for same interface",
            "description": "1. **Description:** `IouCfg` refers to the minter as `InflationMinter`, while `InflationMinter` refers to the token as `IERC20Mintable`, creating inconsistency.\n2. **Cause:** Lack of naming standardization across contracts.\n3. **Exploitation:** No direct exploit, but increases cognitive load and risk of errors during development or review.\n4. **Impact:** Reduced code readability and maintainability.\n",
            "severity": null,
            "location": [
                "IouCfg.sol",
                "InflationMinter.sol"
            ],
            "files": []
        },
        {
            "id": 8,
            "category": {},
            "title": "Auth and auth could be confused",
            "description": "1. **Description:** The constructor uses `Auth(auth)` where `Auth` is the contract and `auth` is the parameter, which is confusing.\n2. **Cause:** Poor variable naming that makes it hard to distinguish between type and instance.\n3. **Exploitation:** Could lead to developer errors during maintenance or upgrades.\n4. **Impact:** Increased risk of misconfiguration or authorization bugs.\n",
            "severity": null,
            "location": [
                "IouCfg.sol::constructor"
            ],
            "files": []
        },
        {
            "id": 9,
            "category": {},
            "title": "Comment in IouCfg::transferFrom() can be improved to be easier to understand",
            "description": "1. **Description:** A comment in `IouCfg::transferFrom()` is unclear and could be improved.\n2. **Cause:** Insufficient documentation of complex logic.\n3. **Exploitation:** No direct security risk, but may lead to misunderstandings during audits or maintenance.\n4. **Impact:** Reduced code readability and increased risk of incorrect modifications.\n",
            "severity": null,
            "location": [
                "IouCfg.sol::transferFrom"
            ],
            "files": []
        },
        {
            "id": 10,
            "category": {},
            "title": "Function CFG::burn() doesn't call _moveDelegateVotes()",
            "description": "1. **Description:** `CFG::burn()` does not call `_moveDelegateVotes()`, unlike similar functions in `DelegationToken`, potentially leaving stale delegations.\n2. **Cause:** Missing call to update delegation state when tokens are burned.\n3. **Exploitation:** An attacker could manipulate governance by maintaining delegate votes despite having no underlying tokens.\n4. **Impact:** Governance system integrity could be compromised due to mismatched vote power and token ownership.\n",
            "severity": null,
            "location": [
                "CFG.sol::burn"
            ],
            "files": []
        },
        {
            "id": 11,
            "category": {},
            "title": "Invalid signatures not detected in delegateWithSig()",
            "description": "1. **Description:** `delegateWithSig()` does not validate signatures properly and allows `delegator == address(0)` in case of invalid signatures.\n2. **Cause:** Missing signature validation logic.\n3. **Exploitation:** An attacker could set a delegate for `address(0)` or trigger unwanted events.\n4. **Impact:** Corruption of delegation state and potential future risks if `address(0)` ever holds tokens.\n",
            "severity": null,
            "location": [
                "CFG.sol::delegateWithSig"
            ],
            "files": []
        },
        {
            "id": 12,
            "category": {},
            "title": "msg.sender of CFG.sol might hold unwanted authorizations",
            "description": "1. **Description:** `msg.sender` in `CFG.sol` is authorized via `auth` and remains authorized even after `ward` is set.\n2. **Cause:** Failure to revoke initial permissions post-deployment.\n3. **Exploitation:** The deployer could retain unintended minting or configuration privileges.\n4. **Impact:** Risk of unauthorized token minting or contract manipulation.\n",
            "severity": null,
            "location": [
                "CFG.sol::constructor"
            ],
            "files": []
        },
        {
            "id": 13,
            "category": {},
            "title": "Use of balanceOf() in burn() not optimal",
            "description": "1. **Description:** `burn()` calls both `balanceOf()` and `_balanceOf()`, duplicating storage reads.\n2. **Cause:** Inefficient use of cached values.\n3. **Exploitation:** No security risk, but wastes gas.\n4. **Impact:** Higher transaction costs than necessary.\n",
            "severity": null,
            "location": [
                "CFG.sol::burn"
            ],
            "files": []
        },
        {
            "id": 14,
            "category": {},
            "title": "Optimization possible for calculation of totalSupply",
            "description": "1. **Description:** `totalSupply` is updated using `totalSupply = totalSupply - value` instead of the more efficient `totalSupply -= value`.\n2. **Cause:** Suboptimal arithmetic operation.\n3. **Exploitation:** No exploit, but higher gas usage.\n4. **Impact:** Increased gas costs for token burns and mints.\n",
            "severity": null,
            "location": [
                "CFG.sol"
            ],
            "files": []
        },
        {
            "id": 15,
            "category": {},
            "title": "transfer() and transferFrom() don't check result of their super functions",
            "description": "1. **Description:** These functions do not check the return value of their parent implementations.\n2. **Cause:** Assumption that super functions always return true, which may not hold in all contexts.\n3. **Exploitation:** If a parent contract changes behavior, transfers could silently fail.\n4. **Impact:** Risk of undetected transfer failures, leading to user fund loss or incorrect state.\n",
            "severity": null,
            "location": [
                "CFG.sol::transfer",
                "CFG.sol::transferFrom"
            ],
            "files": []
        },
        {
            "id": 16,
            "category": {},
            "title": "The repository protocol-v3 might not be accessible",
            "description": "1. **Description:** The `protocol-v3` repository may not be publicly accessible, hindering full auditability.\n2. **Cause:** External dependency not available for review.\n3. **Exploitation:** Prevents complete verification of integrated code.\n4. **Impact:** Reduced transparency and trust in the codebase.\n",
            "severity": null,
            "location": [],
            "files": []
        },
        {
            "id": 17,
            "category": {},
            "title": "delegateWithSig() doesn't support signatures from smart contract accounts",
            "description": "1. **Description:** Unlike `permit()`, `delegateWithSig()` does not support signatures from smart contract wallets.\n2. **Cause:** Uses raw `ecrecover` instead of `isValidSignature()` compatible with ERC-1271.\n3. **Exploitation:** Smart contract accounts (e.g., ERC-4337 wallets) cannot delegate votes.\n4. **Impact:** Excludes modern wallet architectures from participating in governance.\n",
            "severity": null,
            "location": [
                "CFG.sol::delegateWithSig"
            ],
            "files": []
        },
        {
            "id": 18,
            "category": {},
            "title": "No interface file for CFG.sol exists",
            "description": "1. **Description:** There is no `ICFG.sol` interface, making integrations harder.\n2. **Cause:** Missing abstraction layer for external contracts.\n3. **Exploitation:** No direct exploit, but increases integration complexity.\n4. **Impact:** Reduced interoperability and increased risk of integration errors.\n",
            "severity": null,
            "location": [
                "CFG.sol"
            ],
            "files": []
        }
    ]
}