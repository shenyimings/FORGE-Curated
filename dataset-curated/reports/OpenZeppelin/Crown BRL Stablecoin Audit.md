\- July 28, 2025

![](https://www.openzeppelin.com/hs-fs/hubfs/oz-profile-1.png?width=22&height=22&name=oz-profile-1.png)

Summary
-------

**Type:** Stablecoins  
**Timeline:** July 15, 2025 → July 18, 2025**Languages:** Solidity

**Findings**Total issues: 8 (8 resolved)  
Critical: 0 (0 resolved) · High: 0 (0 resolved) · Medium: 0 (0 resolved) · Low: 3 (3 resolved)

**Notes & Additional Information**5 notes raised (5 resolved)

Scope
-----

OpenZeppelin audited the [crown-xyz/crown-contracts](https://github.com/crown-xyz/crown-contracts) repository at commit [13631ab](https://github.com/crown-xyz/crown-contracts/tree/13631abf8ba2f2c183918ec288781c297b344d14).

In scope were the following files:

`contracts
├── BRLV.sol
├── BRLY.sol
├── YieldStripping.sol
└── wBRLY.sol` 

`BRLY.sol` was diff-audited against `USDM.sol` at commit [2f0e2f0](https://github.com/mountainprotocol/tokens/commit/2f0e2f08362fc44360357627b390d21b42031265), while `wBRLY.sol` was diff-audited against `wUSDM.sol` at commit [78c6556](https://github.com/mountainprotocol/tokens/commit/78c6556badd1c8db2de24dbcf2adca60436d9543).

System Overview
---------------

This is a brief audit of 4 files, with 2 of them being diff-audited against the existing USDM codebase. BRLY is a rebasing token similar to the USDM token with added functionality such as a maximum reward multiplier increment ratio and its setter function. This function ensures that the new reward ratio is not over the existing maximum value to avoid profitable just-in-time deposit attacks. The `BRLY` contract also adds a function that rounds up the value when converting to shares during burning. This helps ensure that rounding errors favor protocol solvency.

BRLV is a tokenized vault that has BRLY as the underlying asset. It inherits the `YieldStripping` contract, allowing for the equal-amount exchange of an underlying asset that is supposed to be a yield-bearing ERC-20 token. `BRLV` can be considered a simplified version of an ERC-4626 vault, since any overflowing token supply generated by rebasing will be held for distribution afterwards. The additional yield is distributed by a permissioned claim workflow.

Security Model and Trust Assumptions
------------------------------------

The contracts under review are built on fairly standard modules such ERC-4626 vault and ERC-20. In addition, they use OpenZeppelin's UUPS upgradeability pattern to allow for logical upgrades in the future.

### Privileged Roles

Throughout the codebase, multiple privileged roles were identified:

*   `CLAIM_ROLE`
*   `UPGRADE_ROLE`
*   `PAUSE_ROLE`
*   `DEFAULT_ADMIN_ROLE`
*   `ORACLE_ADMIN_ROLE`
*   `MINTER_ROLE`
*   `BURNER_ROLE`

It is assumed that the above-listed roles will be granted to trusted accounts that will always behave properly.

Low Severity
------------

In `BRLV.sol`, the [comment in line 123](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/BRLV.sol#L123) states that a token transfer will be reverted if either the `from` or `to` address is "blocked". However, the function only [checks if the `from` address is blocked](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/BRLV.sol#L128-L130). This is also reflected by the [comment in line 127](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/BRLV.sol#L127), which states that only the sender is blocked.

Consider either changing the comment in line 123 to reflect the actual behavior of the function, or implementing a separate check for the `to` address and removing the comment in line 127.

_**Update:** Resolved in [commit 3d0a80 in pull request #19](https://github.com/crown-xyz/crown-contracts/pull/19/commits/3d0a80796efe22b0e2096f4ef2c090c7aa4390b2)_

### Missing Docstrings

Throughout the in-scope codebase, multiple instances of missing docstrings were identified. For instance, in [line 107](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/YieldStripping.sol#L106:107) of `YieldStripping.sol`

Consider thoroughly documenting all functions (and their parameters) that are part of any contract's public API. Functions implementing sensitive functionality, even if not public, should be clearly documented as well. When writing docstrings, consider following the [Ethereum Natural Specification Format](https://solidity.readthedocs.io/en/develop/natspec-format.html) (NatSpec).

_**Update:** Resolved in [commit fb9260 in pull request #20](https://github.com/crown-xyz/crown-contracts/pull/20/commits/fb92602b1a533af2c7997a0d75a1460836684cef)_

### Rounding Errors in `_burn` May Leave Dust in Accounts

The `_burn` function is needed for both the `withdraw` and access-controlled `burn` flows. Within the [`withdraw`](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/YieldStripping.sol#L99) flow, users must request an amount of `assets` to withdraw, which will be converted to `shares` that are then burned from their accounts. However, due to the [`maxWithdrawal` limit](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/YieldStripping.sol#L100) and the use of [`convertToSharesRoundUp`](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/BRLY.sol#L298) (which still causes some rounding errors), it is nearly impossible for a user to withdraw their total balance of `shares`. The access-controlled `burn` function is also prone to leaving some dust in accounts when attempting to burn all `shares` in accounts. This is partially due to the `convertToSharesRoundUp` function.

In both cases, due to the nature of rebasing tokens, the `assets` specified for an account may correspond to a different amount of `shares` than intended by the time a transaction is included in a block. Finally, [the check within `_burn` that `accountShares < shares`](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/BRLY.sol#L301-L303) means that over-estimating `assets` is not a viable way to burn tokens, as execution will revert if over-estimation is done.

Consider implementing some flow that burns all shares in a user's account. This will allow the contract to function more cleanly and reduce lost tokens. This could be achieved, for example, by implementing a different check in `_burn` which allows over-estimation, or by implementing special `withdrawAll` or `burnAll` functions.

_**Update:** Resolved in [commit 20d92a](https://github.com/crown-xyz/crown-contracts/pull/21/commits/20d92ac735db24ca63935fa7efac981ddf00a8ac) of pull request #21._

Notes & Additional Information
------------------------------

### `YieldStrippable.sol` Should Be Renamed

[`YieldStrippable.sol`](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/interfaces/YieldStrippable.sol) only contains the `IYieldStrippable` interface.

To better follow the best-practice naming standards and improve the clarity of the codebase, consider renaming `YieldStrippable.sol` to `IYieldStrippable.sol` and changing [the import within `YieldStripping.sol`](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/YieldStripping.sol#L11) to match the new filename.

_**Update:** Resolved in [commit 596b36 in pull request #22](https://github.com/crown-xyz/crown-contracts/pull/22/commits/596b368bbc3408dc678b4bf452114b4d3ddba043)_

### `IBRLY` Should Be in a Separate File

The [`IBRLY` interface](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/BRLV.sol#L16-L29) is declared within [`BRLV.sol`](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/BRLV.sol) alongside the [`BRLV` contract](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/BRLV.sol#L35).

Consider separating the `IBRLY` interface into its own file, `IBRLY.sol`. Doing so will help improve the clarity and maintainability of the codebase.

_**Update:** Resolved in [commit 404523 in pull request #23](https://github.com/crown-xyz/crown-contracts/pull/23/commits/4045238c788022760981ebcec6d7836f92c0dc60)_

### `_tryGetAssetDecimals` Is Unused

The `_tryGetAssetDecimals` function in `YieldStripping.sol` is unused.

Consider removing any unused code to improve the clarity and maintainability of the codebase.

_**Update:** Resolved in [commit 9f4098 in pull request #24](https://github.com/crown-xyz/crown-contracts/pull/24/commits/9f409895a320a2c27d629c8d17d9be0bc3194282)_

### Claiming 0 Rewards Possible

The [`claimRewards` function](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/YieldStripping.sol#L107) will successfully execute when `rewards == 0`. This is effectively a no-op, but will pollute event logs with unnecessary event emissions.

Consider implementing a sanity check for the `rewards` amount within `claimRewards`.

_**Update:** Resolved in [commit 0de1f8 in pull request #25](https://github.com/crown-xyz/crown-contracts/pull/25/commits/0de1f89bee532269baba8dd901126e67a3d11496)_

### Unused Imports

Throughout the codebase, multiple instances of unused imports were identified:

*   Import [`ECDSAUpgradeable`](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/BRLV.sol#L7) of `BRLV.sol`
*   Import [`ERC4626Upgradeable`](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/BRLV.sol#L11) of `BRLV.sol`
*   Import [`ECDSAUpgradeable`](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/BRLY.sol#L7) of `BRLY.sol`
*   Import [`IERC4626Upgradeable`](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/YieldStripping.sol#L8) of `YieldStripping.sol`
*   Import [`ECDSAUpgradeable`](https://github.com/crown-xyz/crown-contracts/blob/13631abf8ba2f2c183918ec288781c297b344d14/contracts/LwBRLY.sol#L7) of `wBRLY.sol`

Consider removing any unused imports to improve the overall clarity and maintainability of the codebase.

_**Update:** Resolved in [commit e69fa0 in pull request #26](https://github.com/crown-xyz/crown-contracts/pull/26/commits/e69fa00ce70912131c1a256985c2c1e7fba1ce8f)_ 

Conclusion
----------

The codebase implements a minimal, yield-bearing, rebasing BRL stablecoin token. It features role-based access controls, pausability, and a blocklist mechanism to ensure regulatory compliance.

The audit identified no critical-, high-, or medium-severity issues, with only a few low- and note-severity findings. Recommendations were provided to align the codebase with Solidity best practices and ensure clean, intended functionality. Safe system operation relies on trusted roles acting in the protocol’s best interest, along with real-time monitoring to manage the blocklist effectively.

The audit team commended the minimal design and the reuse of battle-tested contracts, such as Mountain Protocol’s USDM and OpenZeppelin’s libraries, which help minimize potential vulnerabilities.