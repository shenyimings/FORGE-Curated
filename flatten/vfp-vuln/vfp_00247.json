{
    "vfp_id": "vfp_00247",
    "project_name": "Uniswap Calibur Audit.md",
    "findings": [
        {
            "id": 17,
            "category": {
                "1": [
                    "CWE-682"
                ],
                "2": [
                    "CWE-191"
                ]
            },
            "title": "Potential Malformed Calldata",
            "description": "The `removeSelector` function in `CalldataDecoder.sol` performs an unchecked subtraction of 4 from `data.length` in inline assembly without verifying that the input calldata is at least 4 bytes long. If a shorter input is provided, this operation will underflow, resulting in a large, invalid length value, which could lead to undefined behavior or memory corruption in the assembly block. The root cause is the lack of input validation before arithmetic operations in low-level code. An attacker could craft a malicious UserOperation with less than 4 bytes of calldata to trigger this underflow, potentially causing the contract to read garbage data or revert unpredictably. The impact includes denial of service, unexpected reverts in legitimate transactions, or potential exploitation in combination with other vulnerabilities.\n",
            "severity": "High",
            "location": [
                "CalldataDecoder.sol::removeSelector#10",
                "MinimalDelegation.sol::execution data#93"
            ],
            "files": [
                "732a20a8d82f034573c6c7e44160f1860233a946/minimal-delegation/src/libraries/CalldataDecoder.sol"
            ]
        }
    ],
    "affected_files": {
        "CalldataDecoder.sol": "// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.23;\n\n/// @title CalldataDecoder\nlibrary CalldataDecoder {\n    /// @notice Removes the selector from the calldata and returns the encoded params.\n    function removeSelector(bytes calldata data) internal pure returns (bytes calldata params) {\n        assembly {\n            params.offset := add(data.offset, 4)\n            params.length := sub(data.length, 4)\n        }\n    }\n}\n"
    }
}