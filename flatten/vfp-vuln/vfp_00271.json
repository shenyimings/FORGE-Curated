{
    "vfp_id": "vfp_00271",
    "project_name": "Managed Optimistic Oracle Audit.md",
    "findings": [
        {
            "id": 13,
            "category": {
                "1": [
                    "CWE-664"
                ],
                "2": [
                    "CWE-665"
                ],
                "3": [
                    "CWE-1419"
                ],
                "4": [
                    "CWE-1188"
                ],
                "5": [
                    "CWE-453"
                ]
            },
            "title": "DisableableAddressWhitelist Is Not Enforced By Default",
            "description": "The DisableableAddressWhitelist contract has an `isEnforced` flag that defaults to false, meaning the whitelist is inactive upon deployment unless explicitly enabled. This creates a risk that the owner may mistakenly believe the whitelist is active, allowing unauthorized addresses to pass checks. The root cause is the lack of explicit initialization of the `isEnforced` flag to true in the constructor. An attacker could exploit this by interacting with the system during the window when the contract is deployed but not yet enforced, potentially gaining unauthorized access or privileges. The impact is a potential security bypass due to misconfiguration, leading to loss of access control integrity.\n",
            "severity": "Medium",
            "location": [
                "DisableableAddressWhitelist.sol#12"
            ],
            "files": [
                "managed-oracle/src/common/implementation/DisableableAddressWhitelist.sol"
            ]
        }
    ],
    "affected_files": {
        "DisableableAddressWhitelist.sol": "// SPDX-License-Identifier: AGPL-3.0-only\npragma solidity ^0.8.0;\n\nimport {AddressWhitelistInterface} from \"../interfaces/AddressWhitelistInterface.sol\";\nimport {DisableableAddressWhitelistInterface} from \"../interfaces/DisableableAddressWhitelistInterface.sol\";\nimport {AddressWhitelist} from \"./AddressWhitelist.sol\";\n\n/**\n * @title A contract to track a whitelist of addresses with ability to toggle its enforcement.\n */\ncontract DisableableAddressWhitelist is AddressWhitelist, DisableableAddressWhitelistInterface {\n    bool public isEnforced;\n\n    event WhitelistEnforcementSet(bool enforced);\n\n    /**\n     * @notice Disables or enables the whitelist restrictions.\n     * @param enforced True to enforce the whitelist, False to disable it.\n     */\n    function setWhitelistEnforcement(bool enforced) external nonReentrant onlyOwner {\n        isEnforced = enforced;\n        emit WhitelistEnforcementSet(enforced);\n    }\n\n    /**\n     * @notice Checks whether an address is on the whitelist and if the whitelist is enabled.\n     * @param elementToCheck the address to check.\n     * @return True if whitelist enforcement is disabled, or if the address is whitelisted when enforcement is enabled.\n     */\n    function isOnWhitelist(address elementToCheck)\n        public\n        view\n        override(AddressWhitelist, AddressWhitelistInterface)\n        nonReentrantView\n        returns (bool)\n    {\n        return !isEnforced || super.isOnWhitelist(elementToCheck);\n    }\n}\n"
    }
}