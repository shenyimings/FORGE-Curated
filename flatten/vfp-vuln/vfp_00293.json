{
    "vfp_id": "vfp_00293",
    "project_name": "Oxorio SAMM Module Audit.md",
    "findings": [
        {
            "id": 3,
            "category": {
                "1": [
                    "CWE-693"
                ],
                "2": [
                    "CWE-311"
                ],
                "3": [
                    "CWE-312"
                ]
            },
            "title": "Participants Are Partially De-Anonymized",
            "description": "The SAMM contract requires the caller to publicly specify the email domain and public key hash of each participant when submitting a proof. While the identity within the domain is hidden, the domain itself is revealed on-chain, reducing the anonymity set to only those participants sharing the same domain. This partial de-anonymization allows external observers to correlate approvals by domain, weakening the privacy guarantees of the system. The root cause is the design decision to expose the domain as a public signal in the ZK proof verification process. An attacker can exploit this by analyzing transaction patterns and linking approvals from the same domain across different transactions. The impact is a degradation of user privacy, making it easier to profile or target specific organizations or groups using the system.\n",
            "severity": "Medium",
            "location": [
                "samm-contracts/src/interfaces/ISAMM.sol#30-L31"
            ],
            "files": [
                "c2d255dfe6e0be8a1650c6018da37e73f29521ed/samm-contracts/src/interfaces/ISAMM.sol"
            ]
        }
    ],
    "affected_files": {
        "ISAMM.sol": "// SPDX-License-Identifier: GPL-3\n/**\n *     Safe Anonymization Mail Module\n *     Copyright (C) 2024 OXORIO-FZCO\n *\n *     This program is free software: you can redistribute it and/or modify\n *     it under the terms of the GNU General Public License as published by\n *     the Free Software Foundation, either version 3 of the License, or\n *     (at your option) any later version.\n *\n *     This program is distributed in the hope that it will be useful,\n *     but WITHOUT ANY WARRANTY; without even the implied warranty of\n *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *     GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\npragma solidity 0.8.23;\n\nimport {ISafe} from \"../Safe/interfaces/ISafe.sol\";\nimport {ISAMMEvents} from \"./ISAMMEvents.sol\";\nimport {ISAMMErrors} from \"./ISAMMErrors.sol\";\nimport {ISAMMGetters} from \"./ISAMMGetters.sol\";\n\ninterface ISAMM is ISAMMEvents, ISAMMErrors, ISAMMGetters {\n    struct Proof {\n        bytes proof;\n        uint256 commit;\n        string domain;\n        bytes32 pubkeyHash;\n        bool is2048sig;\n    }\n\n    struct TxAllowance {\n        address to;\n        bytes4 selector;\n        uint256 amount;\n    }\n\n    function setup(\n        address safe,\n        uint256 participantsRoot,\n        uint64 threshold,\n        string calldata relayer,\n        address dkimRegistry,\n        TxAllowance[] calldata txAllowances\n    ) external;\n\n    function executeTransaction(\n        address to,\n        uint256 value,\n        bytes memory data,\n        ISafe.Operation operation,\n        Proof[] calldata proofs,\n        uint256 deadline\n    ) external returns (bool success);\n\n    function executeTransactionReturnData(\n        address to,\n        uint256 value,\n        bytes memory data,\n        ISafe.Operation operation,\n        Proof[] calldata proofs,\n        uint256 deadline\n    ) external returns (bool success, bytes memory returnData);\n}\n"
    }
}