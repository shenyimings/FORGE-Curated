{
    "vfp_id": "vfp_00608",
    "project_name": "cantina_tadle_oct2025.pdf",
    "findings": [
        {
            "id": 19,
            "category": {
                "1": [
                    "CWE-284"
                ],
                "2": [
                    "CWE-285"
                ],
                "3": [
                    "CWE-862"
                ]
            },
            "title": "Public initializer allows arbitrary name/symbol",
            "description": "The MonUSD.initialize function is public and can be called by anyone if not atomically invoked during deployment. This allows an attacker to set arbitrary name and symbol values before locking the contract. The root cause is missing access control on a critical initialization function. The impact is potential branding abuse and loss of control over token metadata if deployment is not carefully orchestrated.\n",
            "severity": "Informational",
            "location": [
                "MonUSD.sol::initialize#101-109"
            ],
            "files": [
                "v3-sandbox-audit_1/src/tokens/MonUSD.sol"
            ]
        }
    ],
    "affected_files": {
        "MonUSD.sol": "// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.13;\n\nimport \"@openzeppelin/contracts/access/Ownable2Step.sol\";\nimport \"@openzeppelin/contracts/token/ERC20/ERC20.sol\";\nimport \"@openzeppelin/contracts/token/ERC20/IERC20.sol\";\nimport \"@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol\";\n\n/**\n * @title MonUSD - Tadle Rebase Stablecoin\n * @author Tadle Team (https://tadle.com)\n * @notice A rebase stablecoin using diverse solid assets as collateral\n * @dev Supports multiple stablecoins ($USDT, $USDC and more) as backing assets\n *\n * ███╗   ███╗ ██████╗ ███╗   ██╗██╗   ██╗███████╗██████╗\n * ████╗ ████║██╔═══██╗████╗  ██║██║   ██║██╔════╝██╔══██╗\n * ██╔████╔██║██║   ██║██╔██╗ ██║██║   ██║███████╗██║  ██║\n * ██║╚██╔╝██║██║   ██║██║╚██╗██║██║   ██║╚════██║██║  ██║\n * ██║ ╚═╝ ██║╚██████╔╝██║ ╚████║╚██████╔╝███████║██████╔╝\n * ╚═╝     ╚═╝ ╚═════╝ ╚═╝  ╚═══╝ ╚═════╝ ╚══════╝╚═════╝\n */\ncontract MonUSD is Ownable2Step, ERC20 {\n    /*//////////////////////////////////////////////////////////////\n                            STATE VARIABLES\n    //////////////////////////////////////////////////////////////*/\n\n    /// @notice Mapping of supported stablecoin addresses to their decimal places\n    /// @dev Zero value indicates the stablecoin is not supported\n    mapping(address => uint8) public supportedStablecoins;\n\n    /// @notice Array containing all supported stablecoin addresses\n    /// @dev Used for enumeration and batch operations\n    address[] public stablecoinsList;\n\n    /// @notice Initialization flag to prevent multiple initialization calls\n    /// @dev Set to true after successful initialization\n    bool private initialized;\n\n    /// @notice Token name storage\n    /// @dev Set during initialization, overrides ERC20 default\n    string private _name;\n\n    /// @notice Token symbol storage\n    /// @dev Set during initialization, overrides ERC20 default\n    string private _symbol;\n\n    /*//////////////////////////////////////////////////////////////\n                                EVENTS\n    //////////////////////////////////////////////////////////////*/\n\n    /// @notice Emitted when a new stablecoin is added to the supported list\n    /// @param stablecoin Address of the added stablecoin contract\n    /// @param decimals Number of decimal places for the stablecoin\n    event StablecoinAdded(address indexed stablecoin, uint8 decimals);\n\n    /// @notice Emitted when a stablecoin is removed from the supported list\n    /// @param stablecoin Address of the removed stablecoin contract\n    event StablecoinRemoved(address indexed stablecoin);\n\n    /// @notice Emitted when a user deposits stablecoins and receives MonUSD\n    /// @param user Address of the user making the deposit\n    /// @param stablecoin Address of the deposited stablecoin\n    /// @param amount Amount of stablecoin deposited (in stablecoin's decimals)\n    /// @param monAmount Amount of MonUSD minted (in 18 decimals)\n    event TokensDeposited(address indexed user, address indexed stablecoin, uint256 amount, uint256 monAmount);\n\n    /// @notice Emitted when a user withdraws stablecoins by burning MonUSD\n    /// @param user Address of the user making the withdrawal\n    /// @param stablecoin Address of the withdrawn stablecoin\n    /// @param monAmount Amount of MonUSD burned (in 18 decimals)\n    /// @param stablecoinAmount Amount of stablecoin withdrawn (in stablecoin's decimals)\n    event TokensWithdrawn(\n        address indexed user, address indexed stablecoin, uint256 monAmount, uint256 stablecoinAmount\n    );\n\n    /// @notice Emitted when MonUSD tokens are minted by the owner\n    /// @param to Address receiving the newly minted tokens\n    /// @param amount Amount of MonUSD tokens minted (in 18 decimals)\n    event TokensMinted(address indexed to, uint256 amount);\n\n    /*//////////////////////////////////////////////////////////////\n                              CONSTRUCTOR\n    //////////////////////////////////////////////////////////////*/\n\n    /// @notice Constructor that initializes the contract with empty name and symbol\n    /// @dev Name and symbol are set during initialization to support proxy patterns\n    /// @custom:oz-upgrades-unsafe-allow constructor\n    constructor() ERC20(\"\", \"\") Ownable(msg.sender) {}\n\n    /*//////////////////////////////////////////////////////////////\n                           INITIALIZATION\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice Initializes the contract with token name and symbol\n     * @dev Can only be called once due to initialization guard\n     * @param __name Token name for the MonUSD token\n     * @param __symbol Token symbol for the MonUSD token\n     * @custom:initialization Must be called after deployment for proxy contracts\n     */\n    function initialize(string memory __name, string memory __symbol) public {\n        require(!initialized, \"MonUSD: contract already initialized\");\n        require(bytes(__name).length > 0, \"MonUSD: token name cannot be empty\");\n        require(bytes(__symbol).length > 0, \"MonUSD: token symbol cannot be empty\");\n\n        initialized = true;\n        _name = __name;\n        _symbol = __symbol;\n    }\n\n    /*//////////////////////////////////////////////////////////////\n                            TOKEN METADATA\n    //////////////////////////////////////////////////////////////*/\n\n    /// @notice Returns the name of the token\n    /// @return The token name set during initialization\n    function name() public view override returns (string memory) {\n        return _name;\n    }\n\n    /// @notice Returns the symbol of the token\n    /// @return The token symbol set during initialization\n    function symbol() public view override returns (string memory) {\n        return _symbol;\n    }\n\n    /*//////////////////////////////////////////////////////////////\n                        STABLECOIN MANAGEMENT\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice Adds a new stablecoin to the list of supported collateral assets\n     * @dev Validates the stablecoin contract and retrieves its decimal configuration\n     * @param stablecoin Address of the ERC20 stablecoin contract to add\n     * @custom:access-control Only callable by the contract owner\n     * @custom:validation Checks for valid address and decimal retrieval\n     */\n    function addStablecoin(address stablecoin) external onlyOwner {\n        require(stablecoin != address(0), \"MonUSD: stablecoin address cannot be zero\");\n        require(supportedStablecoins[stablecoin] == 0, \"MonUSD: stablecoin already supported\");\n\n        try IERC20Metadata(stablecoin).decimals() returns (uint8 decimals__) {\n            supportedStablecoins[stablecoin] = decimals__;\n            stablecoinsList.push(stablecoin);\n            emit StablecoinAdded(stablecoin, decimals__);\n        } catch {\n            revert(\"MonUSD: failed to retrieve stablecoin decimals\");\n        }\n    }\n\n    /**\n     * @notice Removes a stablecoin from the list of supported collateral assets\n     * @dev Removes from both mapping and array, maintaining array integrity\n     * @param stablecoin Address of the stablecoin contract to remove\n     * @custom:access-control Only callable by the contract owner\n     * @custom:array-management Maintains stablecoinsList array integrity\n     */\n    function removeStablecoin(address stablecoin) external onlyOwner {\n        require(supportedStablecoins[stablecoin] != 0, \"MonUSD: stablecoin not currently supported\");\n\n        supportedStablecoins[stablecoin] = 0;\n\n        for (uint256 i = 0; i < stablecoinsList.length; i++) {\n            if (stablecoinsList[i] == stablecoin) {\n                stablecoinsList[i] = stablecoinsList[stablecoinsList.length - 1];\n                stablecoinsList.pop();\n                emit StablecoinRemoved(stablecoin);\n                break;\n            }\n        }\n    }\n\n    /*//////////////////////////////////////////////////////////////\n                        DEPOSIT/WITHDRAW FUNCTIONS\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice Deposits stablecoins and mints equivalent MonUSD tokens\n     * @dev Converts stablecoin amount to 18 decimals and mints MonUSD 1:1\n     * @param stablecoin Address of the supported stablecoin to deposit\n     * @param amount Amount of stablecoin to deposit (in stablecoin's native decimals)\n     * @custom:conversion Automatically handles decimal conversion to 18 decimals\n     * @custom:validation Requires supported stablecoin and sufficient allowance\n     */\n    function deposit(address stablecoin, uint256 amount) external {\n        uint8 stablecoinDecimals = supportedStablecoins[stablecoin];\n        require(stablecoinDecimals != 0, \"MonUSD: stablecoin not supported for deposits\");\n        require(amount > 0, \"MonUSD: deposit amount must be greater than zero\");\n\n        IERC20 token = IERC20(stablecoin);\n        require(token.transferFrom(msg.sender, address(this), amount), \"Transfer failed\");\n\n        uint256 monAmount = _convertToMonAmount(amount, stablecoinDecimals);\n        _mint(msg.sender, monAmount);\n\n        emit TokensDeposited(msg.sender, stablecoin, amount, monAmount);\n    }\n\n    /**\n     * @notice Withdraws stablecoins by burning MonUSD tokens\n     * @dev Burns MonUSD and transfers equivalent stablecoin amount to user\n     * @param stablecoin Address of the supported stablecoin to withdraw\n     * @param monAmount Amount of MonUSD to burn (in 18 decimals)\n     * @custom:conversion Automatically handles decimal conversion from 18 decimals\n     * @custom:validation Requires supported stablecoin and sufficient MonUSD balance\n     */\n    function withdraw(address stablecoin, uint256 monAmount) external {\n        uint8 stablecoinDecimals = supportedStablecoins[stablecoin];\n        require(stablecoinDecimals != 0, \"MonUSD: stablecoin not supported for withdrawals\");\n        require(monAmount > 0, \"MonUSD: withdrawal amount must be greater than zero\");\n        require(balanceOf(msg.sender) >= monAmount, \"MonUSD: insufficient MonUSD balance\");\n\n        uint256 stablecoinAmount = _convertFromMonAmount(monAmount, stablecoinDecimals);\n\n        IERC20 token = IERC20(stablecoin);\n        require(\n            token.balanceOf(address(this)) >= stablecoinAmount,\n            \"MonUSD: insufficient stablecoin reserves for withdrawal\"\n        );\n\n        _burn(msg.sender, monAmount);\n        require(token.transfer(msg.sender, stablecoinAmount), \"Transfer failed\");\n\n        emit TokensWithdrawn(msg.sender, stablecoin, monAmount, stablecoinAmount);\n    }\n\n    /**\n     * @notice Mints MonUSD tokens to a specified address\n     * @dev Only callable by the contract owner for administrative purposes\n     * @param to Address to receive the newly minted tokens\n     * @param amount Amount of MonUSD tokens to mint (in 18 decimals)\n     * @custom:access-control Only callable by the contract owner\n     * @custom:emission Used for administrative token distribution\n     */\n    function mint(address to, uint256 amount) external onlyOwner {\n        require(to != address(0), \"MonUSD: mint recipient cannot be zero address\");\n        require(amount > 0, \"MonUSD: mint amount must be greater than zero\");\n        _mint(to, amount);\n        emit TokensMinted(to, amount);\n    }\n\n    /*//////////////////////////////////////////////////////////////\n                           INTERNAL FUNCTIONS\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice Converts stablecoin amount to MonUSD amount (18 decimals)\n     * @dev Scales up or down based on stablecoin's decimal places\n     * @param amount Amount in stablecoin's native decimals\n     * @param decimals_ Number of decimal places for the stablecoin\n     * @return Equivalent amount normalized to 18 decimals for MonUSD\n     * @custom:conversion Handles both scaling up and scaling down\n     */\n    function _convertToMonAmount(uint256 amount, uint8 decimals_) internal pure returns (uint256) {\n        if (decimals_ > 18) {\n            return amount / (10 ** (decimals_ - 18));\n        } else if (decimals_ < 18) {\n            return amount * (10 ** (18 - decimals_));\n        }\n        return amount;\n    }\n\n    /**\n     * @notice Converts MonUSD amount to stablecoin amount\n     * @dev Scales down or up from 18 decimals to stablecoin's decimal places\n     * @param monAmount Amount in MonUSD (18 decimals)\n     * @param decimals_ Number of decimal places for the target stablecoin\n     * @return Equivalent amount normalized to stablecoin's native decimals\n     * @custom:conversion Handles both scaling up and scaling down\n     */\n    function _convertFromMonAmount(uint256 monAmount, uint8 decimals_) internal pure returns (uint256) {\n        if (decimals_ > 18) {\n            return monAmount * (10 ** (decimals_ - 18));\n        } else if (decimals_ < 18) {\n            return monAmount / (10 ** (18 - decimals_));\n        }\n        return monAmount;\n    }\n\n    /*//////////////////////////////////////////////////////////////\n                            VIEW FUNCTIONS\n    //////////////////////////////////////////////////////////////*/\n\n    /**\n     * @notice Returns the complete list of supported stablecoin addresses\n     * @dev Provides enumeration of all stablecoins that can be used for deposits/withdrawals\n     * @return Array of supported stablecoin contract addresses\n     * @custom:enumeration Used for frontend integration and batch operations\n     */\n    function getSupportedStablecoins() external view returns (address[] memory) {\n        return stablecoinsList;\n    }\n}\n"
    }
}