{
    "vfp_id": "vfp_00253",
    "project_name": "Frax0 Mesh - Zellic Audit Report.pdf",
    "findings": [
        {
            "id": 1,
            "category": {
                "1": [
                    "CWE-691"
                ],
                "2": [
                    "CWE-670"
                ]
            },
            "title": "Inconsistent native fee refund recipient in _remoteMint",
            "description": "In the _remoteMint function of the RemoteCustodian contract, excess native fees are refunded to the _receiver address when the destination is local, but to msg.sender when it is cross-chain. This inconsistency arises from improper handling of refund logic based on the execution path. An attacker could manipulate the refund destination by choosing a local EID, causing fees paid by msg.sender to be sent to a different address (_receiver), effectively stealing the payer's funds. This leads to misdirected refunds and a poor user experience, undermining trust in the system's fairness and correctness.\n",
            "severity": "Low",
            "location": [
                "RemoteCustodian.sol::_remoteMint"
            ],
            "files": [
                "b8d76da3a2bb5ff1fc557c194f8fe6496873959d/frax-oft-upgradeable/contracts/FraxOFTAdapterUpgradeable.sol"
            ]
        }
    ],
    "affected_files": {
        "FraxOFTAdapterUpgradeable.sol": "// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.22;\n\nimport { OFTAdapterUpgradeable } from \"@fraxfinance/layerzero-v2-upgradeable/oapp/contracts/oft/OFTAdapterUpgradeable.sol\";\n\ncontract FraxOFTAdapterUpgradeable is OFTAdapterUpgradeable {\n    constructor(\n        address _token,\n        address _lzEndpoint\n    ) OFTAdapterUpgradeable(_token, _lzEndpoint) {\n        _disableInitializers();\n    }\n\n    function version() public pure returns (string memory) {\n        return \"1.0.1\";\n    }\n\n    // Admin\n\n    function initialize(address _delegate) external initializer {\n        __OFTCore_init(_delegate);\n        __Ownable_init();\n        _transferOwnership(_delegate);\n    }\n}\n"
    }
}