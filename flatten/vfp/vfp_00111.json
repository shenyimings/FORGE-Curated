{
    "vfp_id": "vfp_00111",
    "project_name": "cantina_coinbase_bridge_aug2025.pdf",
    "findings": [
        {
            "id": 7,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1164"
                ],
                "3": [
                    "CWE-561"
                ]
            },
            "title": "Remove unused struct, constants and functions",
            "description": "Several structs, constants, and functions are defined but never used in the codebase. The cause is code remnants from development or refactoring. Not a direct security risk, but increases code complexity and maintenance burden. The impact is reduced code clarity and increased risk of confusion during future audits or updates.\n",
            "severity": "Informational",
            "location": [
                "SVMBridgeLib.sol#L8-L22",
                "SVMLib.sol#L76",
                "SVMLib.sol#L99",
                "mod.rs#L23-L29"
            ],
            "files": [
                "bridge/base/src/libraries/SVMBridgeLib.sol"
            ]
        }
    ],
    "affected_files": {
        "SVMBridgeLib.sol": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.28;\n\nimport {Ix, Pubkey, SVMLib} from \"./SVMLib.sol\";\nimport {SolanaTokenType, Transfer} from \"./TokenLib.sol\";\n\nlibrary SVMBridgeLib {\n    //////////////////////////////////////////////////////////////\n    ///                       Constants                        ///\n    //////////////////////////////////////////////////////////////\n\n    /// @notice The TokenProgram ID on Solana (TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA).\n    Pubkey private constant _TOKEN_PROGRAM_ID =\n        Pubkey.wrap(0x06ddf6e1d765a193d9cbe146ceeb79ac1cb485ed5f5b37913a8cf5857eff00a9);\n\n    /// @notice The TokenProgram 2022 ID on Solana (TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb).\n    Pubkey private constant _TOKEN_PROGRAM_2022_ID =\n        Pubkey.wrap(0x06ddf6e1ee758fde18425dbce46ccddab61afc4d83b90d27febdf928d8a18bfc);\n\n    /// @notice The SystemProgram ID on Solana.\n    Pubkey private constant _SYSTEM_PROGRAM_ID =\n        Pubkey.wrap(0x0000000000000000000000000000000000000000000000000000000000000000);\n\n    //////////////////////////////////////////////////////////////\n    ///                     Internal Functions                 ///\n    //////////////////////////////////////////////////////////////\n\n    /// @notice Serializes a Message::Call variant to Borsh-compatible bytes.\n    ///\n    /// @param ixs The Solana instructions.\n    ///\n    /// @return Serialized Message::Call bytes ready for Solana deserialization\n    function serializeCall(Ix[] memory ixs) internal pure returns (bytes memory) {\n        return abi.encodePacked(uint8(0), SVMLib.serializeIxs(ixs));\n    }\n\n    /// @notice Serializes a Message::Transfer variant to Borsh-compatible bytes.\n    ///\n    /// @param transfer The token transfer to serialize.\n    /// @param tokenType The Solana token type.\n    /// @param ixs The optional Solana instructions.\n    ///\n    /// @return Serialized Message::Transfer bytes ready for Solana deserialization\n    function serializeTransfer(Transfer memory transfer, SolanaTokenType tokenType, Ix[] memory ixs)\n        internal\n        pure\n        returns (bytes memory)\n    {\n        // Variant discriminator for Transfer (1)\n        bytes memory result = abi.encodePacked(uint8(1));\n\n        if (tokenType == SolanaTokenType.Sol) {\n            result = abi.encodePacked(\n                result,\n                uint8(0), // Sol\n                transfer.localToken, // remote_token\n                transfer.to, // to\n                SVMLib.toU64LittleEndian(transfer.remoteAmount) // amount\n            );\n        } else if (tokenType == SolanaTokenType.Spl) {\n            result = abi.encodePacked(\n                result,\n                uint8(1), // Spl\n                transfer.localToken, // remote_token\n                transfer.remoteToken, // local_token\n                transfer.to, // to\n                SVMLib.toU64LittleEndian(transfer.remoteAmount) // amount\n            );\n        } else if (tokenType == SolanaTokenType.WrappedToken) {\n            result = abi.encodePacked(\n                result,\n                uint8(2), // WrappedToken\n                transfer.remoteToken, // local_token\n                transfer.to, // to\n                SVMLib.toU64LittleEndian(transfer.remoteAmount) // amount\n            );\n        }\n\n        // Serialize the instructions array\n        result = abi.encodePacked(result, SVMLib.serializeIxs(ixs));\n\n        return result;\n    }\n}\n"
    }
}