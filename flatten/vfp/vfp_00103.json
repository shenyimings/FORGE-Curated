{
    "vfp_id": "vfp_00103",
    "project_name": "ZEROBASE Token Audit.md",
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-710"
                ]
            },
            "title": "Hardcoded Etherscan API Keys",
            "description": "The ZeroBase.s.sol deployment script contains commented-out Forge CLI commands that include hardcoded Etherscan API keys. The root cause is the inclusion of sensitive credentials directly in source code, even when inactive. Although these commands are not executed, the presence of API keys in public repositories poses a security risk, as they can be scraped and abused, leading to quota exhaustion or unauthorized access to Etherscan's API services. This also reflects poor maintainability and operational security practices. The impact includes potential disruption of development workflows due to revoked or rate-limited API access if keys are compromised.\n",
            "severity": "Low",
            "location": [
                "ZeroBase.s.sol#L24-L25"
            ],
            "files": [
                "Economics/script/ZeroBase.s.sol"
            ]
        },
        {
            "id": 2,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1076"
                ]
            },
            "title": "Limited Testing in CrossChainTransferScript",
            "description": "The CrossChainTransfer.s.sol script only tests transfers from Ethereum Sepolia to BSC testnet, omitting the reverse direction. This creates an incomplete validation of bidirectional cross-chain functionality, which is essential for a fully operational omnichain token. Additionally, the script uses a hardcoded recipient address that corresponds to the contract owner, which may bypass certain checks and fail to represent real-world usage. The root cause is incomplete test coverage and reliance on privileged addresses. The impact is potential undetected failures in reverse transfers and inaccurate simulation of user interactions.\n",
            "severity": "Low",
            "location": [
                "CrossChainTransfer.s.sol"
            ],
            "files": [
                "Economics/script/CrossChainTransfer.s.sol"
            ]
        },
        {
            "id": 6,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1164"
                ]
            },
            "title": "Unused Import",
            "description": "The script CrossChainTransfer.s.sol imports OFTReceipt from IOFT.sol but does not use it anywhere in the code. Unused imports reduce code clarity and increase compilation overhead. The root cause is failure to clean up unused dependencies after development. The impact is minor but contributes to technical debt and reduces maintainability.\n",
            "severity": "Informational",
            "location": [
                "CrossChainTransfer.s.sol#L7"
            ],
            "files": [
                "Economics/script/CrossChainTransfer.s.sol"
            ]
        },
        {
            "id": 7,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1076"
                ],
                "3": [
                    "CWE-1078"
                ],
                "4": [
                    "CWE-1106"
                ]
            },
            "title": "Literal Number With Many Digits",
            "description": "The initial supply of the ZEROBASE token is defined using the raw literal 1000000000, which is difficult to read and prone to errors. The root cause is the lack of formatting for large numeric literals. This can lead to misinterpretation or typos, especially when verifying supply correctness. The impact is reduced code readability and potential for human error during audits or maintenance. Using scientific notation or underscores (e.g., 1e9 or 1_000_000_000) would improve clarity.\n",
            "severity": "Informational",
            "location": [
                "ZEROBASE.sol#L8"
            ],
            "files": [
                "Economics/src/ZEROBASE.sol"
            ]
        },
        {
            "id": 8,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1059"
                ]
            },
            "title": "Missing Security Contact",
            "description": "The ZEROBASE contract does not include a security contact via NatSpec comment (e.g., @custom:security-contact). This makes it difficult for security researchers to responsibly disclose vulnerabilities. The root cause is omission of standard security metadata. The impact is delayed or failed vulnerability reporting, increasing the window of exposure if a critical issue is discovered post-deployment.\n",
            "severity": "Informational",
            "location": [
                "ZEROBASE.sol"
            ],
            "files": [
                "Economics/src/ZEROBASE.sol"
            ]
        },
        {
            "id": 9,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1059"
                ]
            },
            "title": "Missing Docstrings",
            "description": "The ZEROBASE contract lacks NatSpec documentation for the contract itself, its constants, and constructor. This reduces code readability and tooling support (e.g., documentation generators, IDE hints). The root cause is insufficient inline documentation practices. The impact includes difficulty in understanding contract behavior, increased audit effort, and potential integration errors by third parties.\n",
            "severity": "Informational",
            "location": [
                "ZEROBASE.sol#L7-L16"
            ],
            "files": [
                "Economics/src/ZEROBASE.sol"
            ]
        },
        {
            "id": 10,
            "category": {
                "1": [
                    "CWE-691"
                ],
                "2": [
                    "CWE-841"
                ]
            },
            "title": "Incomplete Automation in SetTrustedRemoteScript for Peer Configuration",
            "description": "The SetTrustedRemote.s.sol script only configures the peer relationship in one direction (Sepolia → BSC), while the reverse configuration is commented out. Although both peers are correctly configured on-chain, the script requires manual intervention to complete setup. The root cause is incomplete automation logic. The impact is operational inefficiency, increased risk of human error during deployment, and reduced reliability of deployment scripts.\n",
            "severity": "Informational",
            "location": [
                "SetTrustedRemote.s.sol#L26-L28"
            ],
            "files": [
                "Economics/script/SetTrustedRemote.s.sol"
            ]
        },
        {
            "id": 11,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1164"
                ]
            },
            "title": "Commented-out code can negatively impact code clarity and readability",
            "description": "The ZeroBase.s.sol script contains redundant commented-out code (e.g., line 10), which degrades code clarity and maintainability. Although one instance was removed, a new commented line was introduced in the fix. The root cause is inconsistent cleanup of development artifacts. The impact is reduced readability and potential confusion for auditors or developers interpreting the code.\n",
            "severity": "Informational",
            "location": [
                "ZeroBase.s.sol#L10"
            ],
            "files": [
                "Economics/script/ZeroBase.s.sol"
            ]
        },
        {
            "id": 12,
            "category": {
                "1": [
                    "CWE-710"
                ]
            },
            "title": "SPDX License Set to Unlicensed",
            "description": "All source files use the SPDX license identifier \"UNLICENSED\", which may lead to legal ambiguity regarding code usage and distribution. The root cause is missing or intentionally omitted licensing. The impact includes uncertainty for contributors and integrators about permitted uses, potentially deterring adoption or collaboration. Adopting a clear open-source license (e.g., MIT, GPL) is considered a best practice.\n",
            "severity": "Informational",
            "location": [],
            "files": [
                "Economics/script/SetTrustedRemote.s.sol",
                "Economics/script/ZeroBase.s.sol",
                "Economics/script/CrossChainTransfer.s.sol",
                "Economics/src/ZEROBASE.sol"
            ]
        }
    ],
    "affected_files": {
        "SetTrustedRemote.s.sol": "// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.22;\n \nimport {Script} from \"../lib/forge-std/src/Script.sol\";\nimport {console2} from \"../lib/forge-std/src/console2.sol\";\nimport \"../src/ZeroBase.sol\";\n \ncontract SetTrustedRemoteScript is Script {\n    address constant ETH_CONTRACT = 0xb733E5fF6361770771DcfE58491713661Ac11bb3; // 替换为ETH Sepolia上的合约地址\n    address constant BSC_CONTRACT = 0x9c8749892De34dCe62C06eb2E0Fb1D62B8601a49; // 替换为BSC测试网上的合约地址\n    \n    // LayerZero Chain IDs\n    uint32 constant ETH_CHAIN_ID = 40161; // ETH Sepolia\n    uint32 constant BSC_CHAIN_ID = 40102; // BSC Testnet\n\n    function run() public {\n        uint256 privateKey = vm.envUint(\"PRIVATE_KEY\");\n        vm.startBroadcast(privateKey);\n\n        // sepolia\n        ZEROBASE ethContract = ZEROBASE(ETH_CONTRACT);\n        ethContract.setPeer(BSC_CHAIN_ID, bytes32(uint256(uint160(BSC_CONTRACT))));\n        console2.log(\"Set BSC as peer on ETH Sepolia\");\n\n        // bnb testnet\n        // ZEROBASE bscContract = ZEROBASE(BSC_CONTRACT);\n        // bscContract.setPeer(ETH_CHAIN_ID, bytes32(uint256(uint160(ETH_CONTRACT))));\n        // console2.log(\"Set ETH as peer on BSC Testnet\");\n\n        vm.stopBroadcast();\n    }\n}\n//forge script script/SetTrustedRemote.s.sol:SetTrustedRemoteScript --rpc-url https://eth-sepolia.api.onfinality.io/public --broadcast\n//forge script script/SetTrustedRemote.s.sol:SetTrustedRemoteScript --rpc-url https://bsc-testnet.public.blastapi.io --broadcast",
        "ZeroBase.s.sol": "// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.22;\n \nimport {Script} from \"../lib/forge-std/src/Script.sol\";\nimport {console2} from \"../lib/forge-std/src/console2.sol\";\nimport \"../src/ZeroBase.sol\";\n \ncontract ZeroBaseScript is Script {\n    address constant LAYERZERO_ENDPOINT = 0x6EDCE65403992e310A62460808c4b910D972f10f;\n    // address constant LAYERZERO_ENDPOINT = 0x6EDCE65403992e310A62460808c4b910D972f10f;\n\n    function run() public {\n        // Setup\n        uint256 privateKey = vm.envUint(\"PRIVATE_KEY\");\n        vm.startBroadcast(privateKey);\n\n        // Deploy\n        ZEROBASE zeroBase = new ZEROBASE(LAYERZERO_ENDPOINT, vm.addr(privateKey), vm.addr(privateKey));\n        console2.log(\"ZEROBASE deployed at:\", address(zeroBase));\n\n        vm.stopBroadcast();\n    }\n}\n//forge script script/ZeroBase.s.sol:ZeroBaseScript --rpc-url https://eth-sepolia.api.onfinality.io/public --broadcast --etherscan-api-key F41MZG297XBH3D4RHMN96Y6S15HYFDJQNC --verify\n//forge script script/ZeroBase.s.sol:ZeroBaseScript --rpc-url https://bsc-testnet.public.blastapi.io --broadcast --etherscan-api-key XUXXIDDRA5UMHVVXFUSKDFUGRXVM5ZX2E2 --verify\n",
        "ZEROBASE.sol": "// SPDX-License-Identifier: UNLICENSED\npragma solidity 0.8.28;\n \nimport {Ownable} from \"@openzeppelin/contracts/access/Ownable.sol\";\nimport {OFT} from \"@layerzerolabs/lz-evm-oapp-v2/contracts/oft/OFT.sol\";\n \ncontract ZEROBASE is OFT {\n    uint256 public constant INITIAL_SUPPLY = 1000000000 * 10 ** 18;\n    constructor(\n        address _lzEndpoint,\n        address _owner,\n        address _receiver\n    ) OFT(\"ZEROBASE Token\", \"ZBT\", _lzEndpoint, _owner) Ownable(_owner) {\n        _mint(_receiver, INITIAL_SUPPLY);\n    }\n}\n",
        "CrossChainTransfer.s.sol": "// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.22;\n \nimport {Script} from \"../lib/forge-std/src/Script.sol\";\nimport {console2} from \"../lib/forge-std/src/console2.sol\";\nimport \"../src/ZeroBase.sol\";\nimport {SendParam, MessagingFee, OFTReceipt} from \"../node_modules/@layerzerolabs/lz-evm-oapp-v2/contracts/oft/interfaces/IOFT.sol\";\nimport {MessagingReceipt} from \"../node_modules/@layerzerolabs/lz-evm-protocol-v2/contracts/interfaces/ILayerZeroEndpointV2.sol\";\nimport { OptionsBuilder } from \"../node_modules/@layerzerolabs/lz-evm-oapp-v2/contracts/oapp/libs/OptionsBuilder.sol\";\n \ncontract CrossChainTransferScript is Script {\n    using OptionsBuilder for bytes;\n    address constant ETH_CONTRACT = 0xb733E5fF6361770771DcfE58491713661Ac11bb3; // ETH Sepolia上的合约地址\n    \n    // LayerZero Chain IDs\n    uint32 constant BSC_CHAIN_ID = 40102; // BSC Testnet\n    \n    address constant TARGET_ADDRESS = 0x2b2E23ceC9921288f63F60A839E2B28235bc22ad;\n\n    function run() public {\n        uint256 privateKey = vm.envUint(\"PRIVATE_KEY\");\n        vm.startBroadcast(privateKey);\n\n        ZEROBASE ethContract = ZEROBASE(ETH_CONTRACT);\n        \n        uint256 amount = 100 * 1e18; // 100 ZB\n\n        bytes memory extraOptions = OptionsBuilder.newOptions().addExecutorLzReceiveOption(200_000, 0);\n\n        SendParam memory sendParam = SendParam({\n            dstEid: BSC_CHAIN_ID,\n            to: bytes32(uint256(uint160(TARGET_ADDRESS))),\n            amountLD: amount,\n            minAmountLD: amount * 95 / 100,\n            extraOptions: extraOptions,\n            composeMsg: \"\",\n            oftCmd: \"\"\n        });\n        \n        MessagingFee memory estimatedFee = ethContract.quoteSend(sendParam, false);\n        console2.log(\"Estimated native fee:\", estimatedFee.nativeFee);\n        console2.log(\"Estimated lzToken fee:\", estimatedFee.lzTokenFee);\n        \n        \n        ethContract.send{value: estimatedFee.nativeFee}(\n            sendParam,\n            estimatedFee,\n            payable(vm.addr(privateKey)) // refund address\n        );\n        \n        console2.log(\"Cross-chain transfer initiated!\");\n\n        vm.stopBroadcast();\n    }\n}\n//forge script script/CrossChainTransfer.s.sol:CrossChainTransferScript --rpc-url https://eth-sepolia.api.onfinality.io/public --broadcast"
    }
}