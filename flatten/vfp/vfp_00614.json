{
    "vfp_id": "vfp_00614",
    "project_name": "f(x) v2 Audit.md",
    "findings": [
        {
            "id": 36,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1076"
                ]
            },
            "title": "Inconsistent usage of `msg.sender`",
            "description": "The `StrategyBase` contract uses `msg.sender` in the `onlyOperator` modifier instead of `_msgSender`, which may break support for meta-transactions if the contract is intended to support them. The cause is inconsistent use of message sender patterns. This could lead to access control issues in meta-transaction contexts. The impact is potential failure of meta-transaction execution or incorrect access control assumptions.\n",
            "severity": null,
            "location": [
                "StrategyBase.sol::onlyOperator#19"
            ],
            "files": [
                "fx-protocol-contracts/contracts/fund/strategy/StrategyBase.sol"
            ]
        }
    ],
    "affected_files": {
        "StrategyBase.sol": "// SPDX-License-Identifier: MIT\n\npragma solidity ^0.8.26;\n\nimport { AccessControl } from \"@openzeppelin/contracts/access/AccessControl.sol\";\n\nabstract contract StrategyBase is AccessControl {\n  bytes32 public constant HARVESTER_ROLE = keccak256(\"HARVESTER_ROLE\");\n\n  address public immutable operator;\n\n  /**\n   * @dev This empty reserved space is put in place to allow future versions to add new\n   * variables without shifting down storage in the inheritance chain.\n   */\n  uint256[50] private __gap;\n\n  modifier onlyOperator() {\n    if (msg.sender != operator) revert();\n    _;\n  }\n\n  constructor(address _admin, address _operator) {\n    operator = _operator;\n\n    _grantRole(DEFAULT_ADMIN_ROLE, _admin);\n  }\n\n  function harvest(address receiver) external onlyRole(HARVESTER_ROLE) {\n    _harvest(receiver);\n  }\n\n  function execute(\n    address to,\n    uint256 value,\n    bytes calldata data\n  ) external onlyOperator returns (bool success, bytes memory returnData) {\n    (success, returnData) = to.call{ value: value }(data);\n  }\n\n  function _harvest(address receiver) internal virtual;\n}\n"
    }
}