{
    "vfp_id": "vfp_00221",
    "project_name": "cantina_steakhouse_nov2025.pdf",
    "findings": [
        {
            "id": 21,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ],
                "3": [
                    "CWE-1288"
                ]
            },
            "title": "Factory mapping can be overwritten",
            "description": "The BoxAdapterFactory allows overwriting the boxAdapter mapping for existing vault-box pairs. While this does not affect on-chain authorization (governance uses vault.addAdapter), it can mislead off-chain tooling that relies on the factory as a source of truth. The root cause is lack of overwrite protection. The impact is informational inconsistency, potentially causing operational confusion or errors in external systems.\n",
            "severity": "Informational",
            "location": [
                "BoxAdapterFactory.sol#L18-L25"
            ],
            "files": [
                "box/src/factories/BoxAdapterFactory.sol"
            ]
        }
    ],
    "affected_files": {
        "BoxAdapterFactory.sol": "// SPDX-License-Identifier: GPL-2.0-or-later\n// Copyright (c) 2025 Morpho Association, Steakhouse Financial\npragma solidity 0.8.28;\n\nimport {BoxAdapter} from \"./../BoxAdapter.sol\";\nimport {IBox} from \"./../interfaces/IBox.sol\";\nimport {IBoxAdapter} from \"./../interfaces/IBoxAdapter.sol\";\nimport {IBoxAdapterFactory} from \"./../interfaces/IBoxAdapterFactory.sol\";\n\ncontract BoxAdapterFactory is IBoxAdapterFactory {\n    /* STORAGE */\n\n    mapping(address parentVault => mapping(IBox box => IBoxAdapter)) public boxAdapter;\n    mapping(address account => bool) public isBoxAdapter;\n\n    /* FUNCTIONS */\n\n    /// @dev Returns the address of the deployed BoxAdapter.\n    function createBoxAdapter(address parentVault, IBox box) external returns (IBoxAdapter) {\n        BoxAdapter _boxAdapter = new BoxAdapter(parentVault, box);\n        boxAdapter[parentVault][box] = _boxAdapter;\n        isBoxAdapter[address(_boxAdapter)] = true;\n        emit CreateBoxAdapter(parentVault, address(box), _boxAdapter);\n        return _boxAdapter;\n    }\n}\n"
    }
}