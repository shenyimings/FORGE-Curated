{
    "vfp_id": "vfp_00415",
    "project_name": "ackee-blockchain-lido-vault-wrapper-report.pdf",
    "findings": [
        {
            "id": 8,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1164"
                ]
            },
            "title": "Unused interfaces and libraries",
            "description": "Several interfaces (ILido, IOperatorGrid, IOssifiableProxy, IBoringSolver) and one library (DoubleRefSlotCache) are defined but not used in the main codebase. This is a code quality issue that increases code bloat and maintenance overhead. The root cause is leftover code from development or testing that was not cleaned up. While unused code does not directly affect security, it can confuse auditors and increase the attack surface if resurrected unintentionally. The team acknowledged that some are used in tests or deploy scripts, but others were removed. The impact is minimal, limited to code clarity and maintainability, hence classified as Informational.\n",
            "severity": "Informational",
            "location": [
                "ILido.sol",
                "IOperatorGrid.sol",
                "IOssifiableProxy.sol",
                "IBoringSolver.sol",
                "IVaultHub.sol::DoubleRefSlotCache"
            ],
            "files": [
                "vaults-wrapper/src/interfaces/core/ILido.sol",
                "vaults-wrapper/src/interfaces/core/IOperatorGrid.sol",
                "vaults-wrapper/src/interfaces/core/IOssifiableProxy.sol",
                "vaults-wrapper/src/interfaces/ggv/IBoringSolver.sol"
            ]
        }
    ],
    "affected_files": {
        "ILido.sol": "// SPDX-FileCopyrightText: 2025 Lido <info@lido.fi>\n// SPDX-License-Identifier: MIT\n\npragma solidity >=0.8.0;\n\nimport {IStETH} from \"./IStETH.sol\";\n\ninterface ILido is IStETH {\n    function submit(address _referral) external payable returns (uint256);\n\n    function resume() external;\n    function resumeStaking() external;\n\n    function isStopped() external view returns (bool);\n\n    function setMaxExternalRatioBP(uint256 _maxExternalRatioBP) external;\n    function removeStakingLimit() external;\n    function isStakingPaused() external view returns (bool);\n\n    function getMaxExternalRatioBP() external view returns (uint256);\n\n    function STAKING_CONTROL_ROLE() external view returns (bytes32);\n\n    function mintShares(address _recipient, uint256 _amountOfShares) external;\n    function burnShares(uint256 _amountOfShares) external;\n}\n",
        "IOperatorGrid.sol": "// SPDX-License-Identifier: MIT\npragma solidity >=0.8.25;\n\nimport {IAccessControlEnumerable} from \"@openzeppelin/contracts/access/extensions/IAccessControlEnumerable.sol\";\n\ninterface IOperatorGrid is IAccessControlEnumerable {\n    event GroupAdded(address indexed nodeOperator, uint256 shareLimit);\n    event GroupShareLimitUpdated(address indexed nodeOperator, uint256 shareLimit);\n    event TierAdded(\n        address indexed nodeOperator,\n        uint256 indexed tierId,\n        uint256 shareLimit,\n        uint256 reserveRatioBP,\n        uint256 forcedRebalanceThresholdBP,\n        uint256 infraFeeBP,\n        uint256 liquidityFeeBP,\n        uint256 reservationFeeBP\n    );\n    event TierChanged(address indexed vault, uint256 indexed tierId, uint256 shareLimit);\n    event TierUpdated(\n        uint256 indexed tierId,\n        uint256 shareLimit,\n        uint256 reserveRatioBP,\n        uint256 forcedRebalanceThresholdBP,\n        uint256 infraFeeBP,\n        uint256 liquidityFeeBP,\n        uint256 reservationFeeBP\n    );\n    event VaultJailStatusUpdated(address indexed vault, bool isInJail);\n\n    struct TierParams {\n        uint256 shareLimit;\n        uint256 reserveRatioBP;\n        uint256 forcedRebalanceThresholdBP;\n        uint256 infraFeeBP;\n        uint256 liquidityFeeBP;\n        uint256 reservationFeeBP;\n    }\n\n    struct Tier {\n        address operator;\n        uint96 shareLimit;\n        uint96 liabilityShares;\n        uint16 reserveRatioBP;\n        uint16 forcedRebalanceThresholdBP;\n        uint16 infraFeeBP;\n        uint16 liquidityFeeBP;\n        uint16 reservationFeeBP;\n    }\n\n    function LIDO_LOCATOR() external view returns (address);\n    function REGISTRY_ROLE() external view returns (bytes32);\n    function DEFAULT_TIER_ID() external view returns (uint256);\n    function DEFAULT_TIER_OPERATOR() external view returns (address);\n\n    function tier(uint256 _tierId) external view returns (Tier memory);\n\n    function tiersCount() external view returns (uint256);\n\n    function effectiveShareLimit(address _vault) external view returns (uint256);\n\n    function isVaultInJail(address _vault) external view returns (bool);\n\n    function vaultTierInfo(address _vault)\n        external\n        view\n        returns (\n            address nodeOperator,\n            uint256 tierId,\n            uint256 shareLimit,\n            uint256 reserveRatioBP,\n            uint256 forcedRebalanceThresholdBP,\n            uint256 infraFeeBP,\n            uint256 liquidityFeeBP,\n            uint256 reservationFeeBP\n        );\n\n    function alterTiers(uint256[] calldata _tierIds, TierParams[] calldata _tierParams) external;\n\n    function registerTiers(address _nodeOperator, TierParams[] calldata _tiers) external;\n\n    function registerGroup(address _nodeOperator, uint256 _shareLimit) external;\n}\n",
        "IOssifiableProxy.sol": "// SPDX-License-Identifier: GPL-3.0\n\n// See contracts/COMPILERS.md\n// solhint-disable-next-line lido/fixed-compiler-version\npragma solidity >=0.4.24;\n\ninterface IOssifiableProxy {\n    function proxy__upgradeTo(address newImplementation) external;\n    function proxy__changeAdmin(address newAdmin) external;\n    function proxy__getAdmin() external view returns (address);\n    function proxy__getImplementation() external view returns (address);\n}\n",
        "IBoringSolver.sol": "// SPDX-License-Identifier: MIT\npragma solidity 0.8.30;\n\nimport {IBoringOnChainQueue} from \"./IBoringOnChainQueue.sol\";\n\ninterface IBoringSolver {\n    enum SolveType {\n        BORING_REDEEM, // Fill multiple user requests with a single transaction.\n        BORING_REDEEM_MINT // Fill multiple user requests to redeem shares and mint new shares.\n    }\n\n    function boringSolve(\n        address initiator,\n        address boringVault,\n        address solveAsset,\n        uint256 totalShares,\n        uint256 requiredAssets,\n        bytes calldata solveData\n    ) external;\n\n    function boringRedeemSolve(\n        IBoringOnChainQueue.OnChainWithdraw[] calldata requests,\n        address teller,\n        bool coverDeficit\n    ) external;\n}\n"
    }
}