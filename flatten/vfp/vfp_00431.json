{
    "vfp_id": "vfp_00431",
    "project_name": "Forte - Zenith Audit Report.pdf",
    "findings": [
        {
            "id": 8,
            "category": {
                "1": [
                    "CWE-435"
                ],
                "2": [
                    "CWE-436"
                ],
                "3": [
                    "CWE-115"
                ]
            },
            "title": "The LiquidityWithdrawn event is used wrongly",
            "description": "The LiquidityWithdrawn event defined in IALTBCEvents.sol has five parameters but is emitted in _emitLiquidityWithdrawn with six arguments, including a recipient address that does not exist in the event definition. This causes the recipient to be incorrectly mapped to the _revenue field, leading to event parsing errors in frontends and indexing services. The root cause is a mismatch between the event signature and its usage. The impact is incorrect data interpretation by off-chain systems, which could mislead users or break integrations relying on accurate event logs.\n",
            "severity": "Informational",
            "location": [
                "IALTBCEvents.sol#L21",
                "ALTBCPool.sol#L308"
            ],
            "files": [
                "0852e9c2c10a707b897dd4691f0bc57a132238c2/liquidity-altbc/src/common/IALTBCEvents.sol"
            ]
        }
    ],
    "affected_files": {
        "IALTBCEvents.sol": "// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.24;\n\nimport \"liquidity-base/src/common/IEvents.sol\";\nimport {ALTBCInput} from \"src/amm/ALTBC.sol\";\n\nevent ALTBCFactoryDeployed(string _version);\n\nevent ALTBCPoolDeployed(\n    address indexed _xToken,\n    address indexed _yToken,\n    string _version,\n    uint16 _lpFee,\n    uint16 _protocolFee,\n    address _protocolFeeCollector,\n    ALTBCInput _tbcInput\n);\n\nevent LiquidityDeposited(\n    address indexed _sender, \n    uint256 indexed _tokenId, \n    uint256 _A,\n    uint256 _B\n);\n\nevent LiquidityWithdrawn(\n    address _sender,\n    uint256 _tokenId, \n    uint256 _A, \n    uint256 _B, \n    uint256 _revenue\n);\n\n\nevent InitialLiquidityPositionMinted(\n    address indexed _sender,\n    uint256 indexed _tokenId,\n    uint256 _initialX\n);"
    }
}