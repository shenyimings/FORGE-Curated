{
    "vfp_id": "vfp_00549",
    "project_name": "cantina_eco_february2025.pdf",
    "findings": [
        {
            "id": 12,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ],
                "3": [
                    "CWE-1286"
                ]
            },
            "title": "Missing validation of orderDataType and incorrect EIP-712 encoding may break ERC-7683 requirement",
            "description": "The `orderDataType` field in `OnchainCrossChainOrder` and `GaslessCrossChainOrder` is not validated against the correct typehashes. Additionally, the EIP-712 encoding contains errors, such as incorrect struct names and missing fields.\n\nThis breaks ERC-7683 compliance, as the standard requires ABI decodability and correct typehash validation.\n\nFillers relying on proper EIP-712 signing may fail to process intents, leading to interoperability issues.\n\nThe impact is low, as it affects compliance and integration but does not directly compromise funds.\n",
            "severity": "Low",
            "location": [
                "EcoERC7683.sol#L21-L47",
                "EcoERC7683.sol#L49-L55"
            ],
            "files": [
                "eco-routes/contracts/types/EcoERC7683.sol"
            ]
        }
    ],
    "affected_files": {
        "EcoERC7683.sol": "/* -*- c-basic-offset: 4 -*- */\n// SPDX-License-Identifier: MIT\npragma solidity ^0.8.26;\n\nimport {TokenAmount, Route, Call} from \"./Intent.sol\";\n/**\n * @title EcoERC7683\n * @dev ERC7683 orderData subtypes designed for Eco Protocol\n */\n\n/**\n * @notice contains everything which, when combined with other aspects of GaslessCrossChainOrder\n * is sufficient to publish an intent via Eco Protocol\n * @dev the orderData field of GaslessCrossChainOrder should be decoded as GaslessCrosschainOrderData\\\n * @param route the route data\n * @param creator the address of the intent creator\n * @param prover the address of the prover contract this intent will be proven against\n * @param nativeValue the amount of native token offered as a reward\n * @param tokens the addresses and amounts of reward tokens\n */\nstruct OnchainCrosschainOrderData {\n    Route route;\n    address creator;\n    address prover;\n    uint256 nativeValue;\n    TokenAmount[] rewardTokens;\n}\n/**\n * @notice contains everything which, when combined with other aspects of GaslessCrossChainOrder\n * is sufficient to publish an intent via Eco Protocol\n * @dev the orderData field of GaslessCrossChainOrder should be decoded as GaslessCrosschainOrderData\n * @param destination the ID of the chain where the intent was created\n * @param inbox the inbox contract on the destination chain that will fulfill the intent\n * @param calls the call instructions to be called during intent fulfillment\n * @param prover the address of the prover contract this intent will be proven against\n * @param nativeValue the amount of native token offered as a reward\n * @param tokens the addresses and amounts of reward tokens\n */\nstruct GaslessCrosschainOrderData {\n    uint256 destination;\n    address inbox;\n    TokenAmount[] routeTokens;\n    Call[] calls;\n    address prover;\n    uint256 nativeValue;\n    TokenAmount[] rewardTokens;\n}\n\n//EIP712 typehashes\nbytes32 constant ONCHAIN_CROSSCHAIN_ORDER_DATA_TYPEHASH = keccak256(\n    \"OnchainCrosschainOrderData(Route route,address creator,address prover,uint256 nativeValue,TokenAmount[] rewardTokens)Route(bytes32 salt,uint256 source,uint256 destination,address inbox,TokenAmount[] tokens,Call[] calls)TokenAmount(address token,uint256 amount)Call(address target,bytes data,uint256 value)\"\n);\nbytes32 constant GASLESS_CROSSCHAIN_ORDER_DATA_TYPEHASH = keccak256(\n    \"GaslessCrosschainOrderData(uint256 destination,address inbox,TokenAmount[] routeTokens,Call[] calls,address prover,uint256 nativeValue,TokenAmount[] rewardTokens)TokenAmount(address token,uint256 amount)Call(address target,bytes data,uint256 value)\"\n);\n"
    }
}