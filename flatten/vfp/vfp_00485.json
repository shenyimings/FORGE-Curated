{
    "vfp_id": "vfp_00485",
    "project_name": "ackee-blockchain-let's-get-hai-new-core-features-report.pdf",
    "findings": [
        {
            "id": 21,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1164"
                ],
                "3": [
                    "CWE-561"
                ]
            },
            "title": "Unused errors",
            "description": "Several custom errors are defined but never used in the codebase, including StakingManager_WithdrawNegativeAmount, StakingManager_InactiveRewardType, and relayer-specific InvalidPriceSource errors. These unused errors increase code bloat and may confuse developers. The root cause is either incomplete implementation or failure to remove deprecated code. Static analysis tools detected these issues. The errors were later removed in a commit, confirming they were unnecessary.\n",
            "severity": "Informational",
            "location": [
                "IStakingManager.sol#101",
                "IStakingManager.sol#116",
                "IBeefyVeloVaultRelayer.sol#14",
                "IYearnVeloVaultRelayer.sol#15"
            ],
            "files": [
                "core/src/interfaces/tokens/IStakingManager.sol"
            ]
        }
    ],
    "affected_files": {
        "IStakingManager.sol": "// SPDX-License-Identifier: GPL-3.0\npragma solidity 0.8.20;\n\nimport {IProtocolToken} from '@interfaces/tokens/IProtocolToken.sol';\nimport {IStakingToken} from '@interfaces/tokens/IStakingToken.sol';\n\nimport {IAuthorizable} from '@interfaces/utils/IAuthorizable.sol';\nimport {IModifiable} from '@interfaces/utils/IModifiable.sol';\n\ninterface IStakingManager is IAuthorizable, IModifiable {\n  // --- Events ---\n\n  /**\n   * @notice Emitted when a new reward type is added\n   * @param  _id Id of the reward type\n   * @param  _rewardToken Address of the reward token\n   * @param  _rewardPool Address of the reward pool\n   */\n  event StakingManagerAddRewardType(uint256 indexed _id, address indexed _rewardToken, address indexed _rewardPool);\n\n  /**\n   * @notice Emitted when an existing reward type is activated\n   * @param  _id Id of the reward type\n   */\n  event StakingManagerActivateRewardType(uint256 indexed _id);\n\n  /**\n   * @notice Emitted when an existing reward type is deactivated\n   * @param  _id Id of the reward type\n   */\n  event StakingManagerDeactivateRewardType(uint256 indexed _id);\n\n  /**\n   * @notice Emitted when a user stakes tokens\n   * @param _account Address of the user staking the tokens\n   * @param _wad Amount of tokens staked\n   */\n  event StakingManagerStaked(address indexed _account, uint256 _wad);\n\n  /**\n   * @notice Emitted when a user initiates a withdrawal of staked tokens\n   * @param  _account Address of the user initiating the withdrawal\n   * @param  _wad Amount of tokens withdrawn\n   */\n  event StakingManagerWithdrawalInitiated(address indexed _account, uint256 _wad);\n\n  /**\n   * @notice Emitted when a user cancels a pending withdrawal of staked tokens\n   * @param  _account Address of the user that cancelled the withdrawal\n   * @param  _wad Amount of tokens in the cancelled withdrawal\n   */\n  event StakingManagerWithdrawalCancelled(address indexed _account, uint256 _wad);\n\n  /**\n   * @notice Emitted when a user withdraws staked tokens from a pending withdrawal\n   * @param  _account Address of the user that withdrew\n   * @param  _wad Amount of tokens withdrawn\n   */\n  event StakingManagerWithdrawn(address indexed _account, uint256 _wad);\n\n  /**\n   * @notice Emitted when an emergency withdrawal is executed\n   * @param  _account Address that the tokens were sent to from the emergency withdrawal\n   * @param  _wad Amount of tokens withdrawn\n   */\n  event StakingManagerEmergencyWithdrawal(address indexed _account, uint256 _wad);\n\n  /**\n   * @notice Emitted when an emergency reward withdrawal is executed\n   * @param  _account Address that the tokens were sent to from the emergency reward withdrawal\n   * @param  _rewardToken Address of the reward token\n   * @param  _wad Amount of reward tokens withdrawn\n   */\n  event StakingManagerEmergencyRewardWithdrawal(address indexed _account, address indexed _rewardToken, uint256 _wad);\n\n  /**\n   * @notice Emitted when a reward is paid to a user\n   * @param  _account Address of the user that earned the rewards\n   * @param  _rewardToken Address of the reward token\n   * @param  _wad Amount of rewards paid\n   * @param  _destination Address of the destination the rewards were sent to\n   */\n  event StakingManagerRewardPaid(\n    address indexed _account, address indexed _rewardToken, uint256 _wad, address indexed _destination\n  );\n\n  // --- Errors ---\n\n  /// @notice Throws when trying to access an invalid reward type\n  error StakingManager_InvalidRewardType();\n\n  /// @notice Throws when trying to stake a null amount\n  error StakingManager_StakeNullAmount();\n\n  /// @notice Throws when trying to stake and mint $stKITE to a null address\n  error StakingManager_StakeNullReceiver();\n\n  /// @notice Throws when trying to withdraw a null amount\n  error StakingManager_WithdrawNullAmount();\n\n  /// @notice Throws when trying to withdraw a negative amount\n  error StakingManager_WithdrawNegativeAmount();\n\n  /// @notice Throws when trying to cancel or withdraw with no pending withdrawal\n  error StakingManager_NoPendingWithdrawal();\n\n  /// @notice Throws when trying to withdraw and the cooldown period hasn't elapsed\n  error StakingManager_CooldownPeriodNotElapsed();\n\n  /// @notice Throws when trying to add a reward type with a null reward token\n  error StakingManager_NullRewardToken();\n\n  /// @notice Throws when trying to add a reward type with a null reward pool\n  error StakingManager_NullRewardPool();\n\n  /// @notice Throws when trying to calculate rewards on an inactive reward type\n  error StakingManager_InactiveRewardType();\n\n  /// @notice Throws when trying to forward rewards without being the account owner\n  error StakingManager_ForwardingOnly();\n\n  // --- Data ---\n\n  struct RewardType {\n    // Address of the reward token\n    address rewardToken;\n    // Address of the reward pool\n    address rewardPool;\n    // Flag if this reward type is currently active\n    bool isActive;\n    // Total amount of rewards accrued by the contract\n    uint256 rewardIntegral;\n    // Total amount of rewards remaining to be claimed\n    uint256 rewardRemaining;\n    // Stores reward integral for each user\n    mapping(address => uint256) rewardIntegralFor;\n    // Stores claimable rewards for each user\n    mapping(address => uint256) claimableReward;\n  }\n\n  struct RewardTypeInfo {\n    // Address of the reward token\n    address rewardToken;\n    // Address of the reward pool\n    address rewardPool;\n    // Flag if this reward type is currently active\n    bool isActive;\n    // Total amount of rewards accrued by the contract\n    uint256 rewardIntegral;\n    // Total amount of rewards remaining to be claimed\n    uint256 rewardRemaining;\n  }\n\n  struct EarnedData {\n    // Address of the reward token\n    address rewardToken;\n    // Amount of rewards\n    uint256 rewardAmount;\n  }\n\n  struct PendingWithdrawal {\n    // Amount of tokens withdrawal was initiated for\n    uint256 amount;\n    // Timestamp of when withdrawal was initiated\n    uint256 timestamp;\n  }\n\n  struct StakingManagerParams {\n    uint256 cooldownPeriod;\n  }\n\n  // --- Registry ---\n\n  /// @notice Address of the protocol token\n  function protocolToken() external view returns (IProtocolToken _protocolToken);\n\n  /// @notice Address of the staking token\n  function stakingToken() external view returns (IStakingToken _stakingToken);\n\n  // --- Params ---\n\n  /**\n   * @notice Getter for the contract parameters struct\n   * @return _params StakingManager parameters struct\n   */\n  function params() external view returns (StakingManagerParams memory _params);\n\n  /**\n   * @notice Getter for the unpacked contract parameters struct\n   * @return _cooldownPeriod How long a user has to wait before they can withdraw after initiating a withdrawal\n   */\n  // solhint-disable-next-line private-vars-leading-underscore\n  function _params() external view returns (uint256 _cooldownPeriod);\n\n  // --- Data ---\n\n  /**\n   * @notice The total amount of reward types\n   * @return _rewards Total amount of reward types [wad]\n   */\n  function rewards() external view returns (uint256 _rewards);\n\n  /**\n   * @notice Returns the reward type info for a given id\n   * @param  _id Id of the reward type\n   * @return _rewardTypeInfo RewardTypeInfo data struct containing non-mapping fields\n   */\n  function rewardTypes(uint256 _id) external view returns (RewardTypeInfo memory _rewardTypeInfo);\n\n  /**\n   * @notice Unpacked data of a reward type\n   * @param _id Id of the reward type\n   * @return _rewardToken Address of the reward token\n   * @return _rewardPool Address of the reward pool\n   * @return _isActive Flag if this reward type is currently active\n   * @return _rewardIntegral Total amount of rewards accrued by the contract\n   * @return _rewardRemaining Total amount of rewards remaining to be claimed\n   */\n  // solhint-disable-next-line private-vars-leading-underscore\n  function _rewardTypes(uint256 _id)\n    external\n    view\n    returns (\n      address _rewardToken,\n      address _rewardPool,\n      bool _isActive,\n      uint256 _rewardIntegral,\n      uint256 _rewardRemaining\n    );\n\n  /**\n   * @notice Returns the reward integral for a specific reward type and user\n   * @param  _id Id of the reward type\n   * @param  _user Address of the user\n   * @return _rewardIntegral The reward integral for the user\n   */\n  function rewardIntegralFor(uint256 _id, address _user) external view returns (uint256 _rewardIntegral);\n\n  /**\n   * @notice Returns the claimable reward for a specific reward type and user\n   * @param  _id Id of the reward type\n   * @param  _user Address of the user\n   * @return _claimableReward The claimable reward for the user\n   */\n  function claimableReward(uint256 _id, address _user) external view returns (uint256 _claimableReward);\n\n  /**\n   * @notice A mapping storing user's staked balances\n   * @param  _account Address of the user\n   * @return _stakedBalance User's staked balance [wad]\n   */\n  function stakedBalances(address _account) external view returns (uint256 _stakedBalance);\n\n  /**\n   * @notice Data of a pending withdrawal\n   * @param  _account Address of the user\n   * @return _pendingWithdrawal PendingWithdrawal type data struct\n   */\n  function pendingWithdrawals(address _account) external view returns (PendingWithdrawal memory _pendingWithdrawal);\n\n  /**\n   * @notice Unpacked data of a pending withdrawal\n   * @param _account Address of the user that initiated the withdrawal\n   * @return _amount Amount of tokens withdrawal was initiated for\n   * @return _timestamp Timestamp of when withdrawal was initiated\n   */\n  // solhint-disable-next-line private-vars-leading-underscore\n  function _pendingWithdrawals(address _account) external view returns (uint256 _amount, uint256 _timestamp);\n\n  // --- Methods ---\n\n  /**\n   * @notice Stake $KITE tokens\n   * @param _account Account that will receive the minted $stKITE\n   * @param _wad Amount of $KITE being staked [wad]\n   */\n  function stake(address _account, uint256 _wad) external;\n\n  /**\n   * @notice Initiates a pending withdrawal\n   * @param _wad Amount of $KITE being withdrawn [wad]\n   */\n  function initiateWithdrawal(uint256 _wad) external;\n\n  /**\n   * @notice Cancels a pending withdrawal\n   */\n  function cancelWithdrawal() external;\n\n  /**\n   * @notice Completes a pending withdrawal\n   */\n  function withdraw() external;\n\n  /**\n   * @notice Emergency withdraw all staked $KITE\n   * @param _rescueReceiver Account that will receive the withdrawn $KITE\n   * @param _wad Amount of $KITE being withdrawn [wad]\n   */\n  function emergencyWithdraw(address _rescueReceiver, uint256 _wad) external;\n\n  /**\n   * @notice Emergency withdraw rewards from the staking manager\n   * @param _id ID of the reward type\n   * @param _rescueReceiver Account that will receive the withdrawn tokens\n   * @param _wad Amount of tokens being withdrawn [wad]\n   */\n  function emergencyWithdrawReward(uint256 _id, address _rescueReceiver, uint256 _wad) external;\n\n  /**\n   * @notice Claims earned rewards\n   * @param _account Address of the account that will receive the rewards\n   */\n  function getReward(address _account) external;\n\n  /**\n   * @notice Claims and forwards earned rewards\n   * @param _account Address of the account that earned the rewards\n   * @param _forwardTo Address of the account that will receive the rewards\n   */\n  function getRewardAndForward(address _account, address _forwardTo) external;\n\n  /**\n   * @notice Add a new reward type\n   * @param _rewardToken Address of the reward token\n   * @param _rewardPool Address of the reward pool\n   */\n  function addRewardType(address _rewardToken, address _rewardPool) external;\n\n  /**\n   * @notice Activate an existing reward type\n   * @param _id ID of the reward type\n   */\n  function activateRewardType(uint256 _id) external;\n\n  /**\n   * @notice Deactivate an existing reward type\n   * @param _id ID of the reward type\n   */\n  function deactivateRewardType(uint256 _id) external;\n\n  /**\n   * @notice Check rewards earned for an account\n   * @param _account Account to check\n   */\n  function earned(address _account) external returns (EarnedData[] memory _claimable);\n\n  /**\n   * @notice Checkpoint account balances\n   * @param _accounts Accounts to checkpoint\n   */\n  function checkpoint(address[2] memory _accounts) external;\n\n  /**\n   * @notice Checkpoint account balance\n   * @param _account Account to checkpoint\n   */\n  function userCheckpoint(address _account) external;\n}\n"
    }
}