{
    "vfp_id": "vfp_00495",
    "project_name": "Paxos Labs - Zenith Audit Report.pdf",
    "findings": [
        {
            "id": 9,
            "category": {
                "1": [
                    "CWE-682"
                ]
            },
            "title": "calculateOfferFees() should round up fee amount",
            "description": "1. **Description:** The `calculateOfferFees` function uses integer division that truncates downward, potentially resulting in a fee amount of zero for very small deposits.\n\n2. **Cause:** The calculation `feeAmount = (amount * offerFeePercentage) / ONE_HUNDRED_PERCENT` truncates instead of rounding up.\n\n3. **Exploitation:** An attacker can submit many small orders with fees that round down to zero, effectively avoiding fees entirely.\n\n4. **Impact:** This allows fee avoidance for micro-transactions, reducing protocol revenue. The impact is low due to minimal financial loss per transaction.\n",
            "severity": "Low",
            "location": [
                "SimpleFeeModule.sol#L31-L44"
            ],
            "files": [
                "0x7032978ef1fc44271145bb593be45be1c7a0b6c5/nucleus-boring-vault/src/helper/one-to-one-queue/SimpleFeeModule.sol"
            ]
        }
    ],
    "affected_files": {
        "SimpleFeeModule.sol": "// SPDX-License-Identifier: Apache-2.0\npragma solidity 0.8.21;\n\nimport { IFeeModule, IERC20 } from \"./interfaces/IFeeModule.sol\";\nimport { FixedPointMathLib } from \"solmate/utils/FixedPointMathLib.sol\";\nimport { IERC721 } from \"@openzeppelin/contracts/token/ERC721/IERC721.sol\";\n\n/**\n * @title SimpleFeeModule\n * @notice A simple fee module implementation that charges a percentage fee\n * @dev Fees are sent to a designated fee recipient\n */\ncontract SimpleFeeModule is IFeeModule {\n\n    using FixedPointMathLib for uint256;\n\n    uint256 constant ONE_HUNDRED_PERCENT = 10_000;\n    uint256 public immutable offerFeePercentage;\n\n    error FeePercentageTooHigh(uint256 feePercentage, uint256 maxAllowed);\n\n    /**\n     * @notice Initialize the SimpleFeeModule\n     * @param _offerFeePercentage Fee percentage on offer assets in basis points\n     */\n    constructor(uint256 _offerFeePercentage) {\n        if (_offerFeePercentage > ONE_HUNDRED_PERCENT) {\n            revert FeePercentageTooHigh(_offerFeePercentage, ONE_HUNDRED_PERCENT);\n        }\n\n        offerFeePercentage = _offerFeePercentage;\n    }\n\n    function calculateOfferFees(\n        uint256 amount,\n        IERC20 offerAsset,\n        IERC20 wantAsset,\n        address receiver\n    )\n        external\n        view\n        override\n        returns (uint256 feeAmount)\n    {\n        feeAmount = amount.mulDivUp(offerFeePercentage, ONE_HUNDRED_PERCENT);\n    }\n\n}\n"
    }
}