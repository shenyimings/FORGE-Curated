{
    "vfp_id": "vfp_00119",
    "project_name": "Pyth Lazer EVM - Zellic Audit Report.pdf",
    "findings": [
        {
            "id": 4,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1164"
                ]
            },
            "title": "Remove unused code",
            "description": "1. **Description:** The PythLazerLib.sol file imports the forge-std console library, which is not used anywhere in the codebase. This import is dead code.\n2. **Cause:** The import was likely added for debugging during development but was not removed before the audit.\n3. **Exploitation:** There is no security risk, but unused imports increase the compiled bytecode size and can mislead auditors into thinking the library is in use.\n4. **Impact:** Slight increase in deployment cost and reduced code readability. It violates best practices for clean, maintainable code.\n",
            "severity": "Informational",
            "location": [
                "PythLazerLib.sol::import {console} from \"forge-std/console.sol\""
            ],
            "files": [
                "pyth-crosschain/lazer/contracts/evm/src/PythLazerLib.sol"
            ]
        }
    ],
    "affected_files": {
        "PythLazerLib.sol": "// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.13;\n\nimport {console} from \"forge-std/console.sol\";\nimport {PythLazer} from \"./PythLazer.sol\";\n\nlibrary PythLazerLib {\n    enum PriceFeedProperty {\n        Price,\n        BestBidPrice,\n        BestAskPrice,\n        PublisherCount,\n        Exponent\n    }\n\n    enum Channel {\n        Invalid,\n        RealTime,\n        FixedRate50,\n        FixedRate200\n    }\n\n    function parsePayloadHeader(\n        bytes calldata update\n    )\n        public\n        pure\n        returns (uint64 timestamp, Channel channel, uint8 feedsLen, uint16 pos)\n    {\n        uint32 FORMAT_MAGIC = 2479346549;\n\n        pos = 0;\n        uint32 magic = uint32(bytes4(update[pos:pos + 4]));\n        pos += 4;\n        if (magic != FORMAT_MAGIC) {\n            revert(\"invalid magic\");\n        }\n        timestamp = uint64(bytes8(update[pos:pos + 8]));\n        pos += 8;\n        channel = Channel(uint8(update[pos]));\n        pos += 1;\n        feedsLen = uint8(update[pos]);\n        pos += 1;\n    }\n\n    function parseFeedHeader(\n        bytes calldata update,\n        uint16 pos\n    )\n        public\n        pure\n        returns (uint32 feed_id, uint8 num_properties, uint16 new_pos)\n    {\n        feed_id = uint32(bytes4(update[pos:pos + 4]));\n        pos += 4;\n        num_properties = uint8(update[pos]);\n        pos += 1;\n        new_pos = pos;\n    }\n\n    function parseFeedProperty(\n        bytes calldata update,\n        uint16 pos\n    ) public pure returns (PriceFeedProperty property, uint16 new_pos) {\n        property = PriceFeedProperty(uint8(update[pos]));\n        pos += 1;\n        new_pos = pos;\n    }\n\n    function parseFeedValueUint64(\n        bytes calldata update,\n        uint16 pos\n    ) public pure returns (uint64 value, uint16 new_pos) {\n        value = uint64(bytes8(update[pos:pos + 8]));\n        pos += 8;\n        new_pos = pos;\n    }\n\n    function parseFeedValueUint16(\n        bytes calldata update,\n        uint16 pos\n    ) public pure returns (uint16 value, uint16 new_pos) {\n        value = uint16(bytes2(update[pos:pos + 2]));\n        pos += 2;\n        new_pos = pos;\n    }\n\n    function parseFeedValueInt16(\n        bytes calldata update,\n        uint16 pos\n    ) public pure returns (int16 value, uint16 new_pos) {\n        value = int16(uint16(bytes2(update[pos:pos + 2])));\n        pos += 2;\n        new_pos = pos;\n    }\n\n    function parseFeedValueUint8(\n        bytes calldata update,\n        uint16 pos\n    ) public pure returns (uint8 value, uint16 new_pos) {\n        value = uint8(update[pos]);\n        pos += 1;\n        new_pos = pos;\n    }\n}\n"
    }
}