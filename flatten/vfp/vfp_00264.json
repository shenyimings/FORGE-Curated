{
    "vfp_id": "vfp_00264",
    "project_name": "Jovay Rollup Contracts Audit.md",
    "findings": [
        {
            "id": 27,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1076"
                ],
                "3": [
                    "CWE-1078"
                ]
            },
            "title": "Non-Explicit Imports",
            "description": "The codebase uses non-explicit import syntax (e.g., `import \"./X.sol\";`) instead of named imports (e.g., `import {X} from \"./X.sol\";`). This can lead to naming conflicts and reduce code clarity, especially in large projects with many contracts. The root cause is deviation from best practices in module organization. While not directly exploitable, this can lead to accidental shadowing or confusion when multiple contracts are imported from the same file. The impact is low, primarily affecting code maintainability and readability.\n",
            "severity": "Low",
            "location": [
                "L1BridgeProof.sol::import#4",
                "L1ERC20Bridge.sol::import#9",
                "L1ERC20Bridge.sol::import#10",
                "L1ETHBridge.sol::import#8",
                "L1ETHBridge.sol::import#10",
                "L1Mailbox.sol::import#5",
                "L1Mailbox.sol::import#6",
                "Rollup.sol::import#4",
                "Rollup.sol::import#7",
                "L2ERC20Bridge.sol::import#6",
                "L2ERC20Bridge.sol::import#7",
                "L2ETHBridge.sol::import#7",
                "L2CoinBase.sol::import#4"
            ],
            "files": [
                "jovay-contracts/rollup_contracts/contracts/L1/bridge/L1BridgeProof.sol"
            ]
        },
        {
            "id": 40,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1076"
                ]
            },
            "title": "Use `calldata` Instead of `memory`",
            "description": "The contract code uses `memory` as the data location for parameters in several `external` functions, when `calldata` would be more appropriate. Since `calldata` is a read-only, non-modifiable area that directly holds function arguments for external calls, using it avoids unnecessary copying of data into memory, thereby reducing gas costs. The root cause is the explicit or default use of `memory` for reference types in external functions where no modification is performed. An attacker cannot directly exploit this issue, but all users of the affected functions will incur higher gas costs than necessary. The impact is an increase in transaction costs for end users, reducing the economic efficiency of the system.\n",
            "severity": "Low",
            "location": [
                "L1BridgeProof.sol::msg_#11",
                "L1BridgeProof.sol::proof_#12",
                "L1ERC20Bridge.sol::msg_#31",
                "L1ERC20Bridge.sol::msg_#48",
                "L1ETHBridge.sol::msg_#16",
                "L1ETHBridge.sol::msg_#29",
                "L1Mailbox.sol::msg_#144",
                "L1Mailbox.sol::proof_#145",
                "L2ERC20Bridge.sol::msg_#28",
                "L2ETHBridge.sol::msg_#21"
            ],
            "files": [
                "jovay-contracts/rollup_contracts/contracts/L1/bridge/L1BridgeProof.sol"
            ]
        },
        {
            "id": 15,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-758"
                ]
            },
            "title": "Floating Pragma",
            "description": "Multiple contracts in the codebase use floating pragma directives (e.g., ^0.8.0), which allow compilation with any minor version of Solidity within the specified range. This introduces risk because newer compiler versions may introduce changes in behavior, optimizations, or bugs that could affect contract security or correctness. The root cause is the use of caret versioning instead of fixed versions in the pragma statements. An attacker could potentially exploit known compiler bugs in a newer version if the contract is recompiled. The impact includes undefined behavior, potential reentrancy or overflow issues due to compiler-level changes, and reduced reproducibility of builds.\n",
            "severity": "Low",
            "location": [
                "L1BridgeProof.sol",
                "L1ERC20Bridge.sol",
                "L1ETHBridge.sol",
                "IL1BridgeProof.sol",
                "IL1ERC20Bridge.sol",
                "IL1ETHBridge.sol",
                "L1Mailbox.sol",
                "Rollup.sol",
                "IL1MailQueue.sol",
                "IL1Mailbox.sol",
                "IRollup.sol",
                "BatchHeaderCodec.sol",
                "ITeeRollupVerifier.sol",
                "IZkRollupVerifier.sol",
                "WithdrawTrieVerifier.sol",
                "L2ERC20Bridge.sol",
                "L2ETHBridge.sol",
                "IL2ERC20Bridge.sol",
                "IL2ETHBridge.sol",
                "L1GasOracle.sol",
                "L2CoinBase.sol",
                "L2Mailbox.sol",
                "IClaimAmount.sol",
                "IL2MailQueue.sol",
                "IL2Mailbox.sol",
                "AppendOnlyMerkleTree.sol",
                "BridgeBase.sol",
                "ERC20Token.sol",
                "MailBoxBase.sol",
                "TokenBridge.sol",
                "IBridgeBase.sol",
                "IERC20Token.sol",
                "IGasPriceOracle.sol",
                "IMailBoxBase.sol",
                "ITokenBridge.sol"
            ],
            "files": [
                "jovay-contracts/rollup_contracts/contracts/L1/bridge/L1BridgeProof.sol"
            ]
        }
    ],
    "affected_files": {
        "L1BridgeProof.sol": "// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.0;\n\nimport \"../../common/BridgeBase.sol\";\nimport \"./interfaces/IL1BridgeProof.sol\";\n\ncontract L1BridgeProof is BridgeBase, IL1BridgeProof {\n    function relayMsgWithProof(\n        uint256 value_,\n        uint256 nonce_,\n        bytes memory msg_,\n        IL1Mailbox.L2MsgProof memory proof_\n    ) external payable whenNotPaused {\n        mailBoxCall(abi.encodeCall(IL1Mailbox.relayMsgWithProof, (toBridge, address(this), value_, nonce_, msg_, proof_)));\n    }\n}\n"
    }
}