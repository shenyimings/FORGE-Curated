{
    "vfp_id": "vfp_00330",
    "project_name": "cantina_rocketpool_jun2025.pdf",
    "findings": [
        {
            "id": 40,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ],
                "3": [
                    "CWE-1284"
                ]
            },
            "title": "Missing guardrails on oDAO voting settings can make the proposal voting process ineffective",
            "description": "Key oDAO voting parameters—proposal.cooldown.time, proposal.vote.time, proposal.vote.delay.time, proposal.execute.time, and proposal.action.time—lack guardrails. This allows arbitrary changes that could break the voting process (e.g., extremely long delays or short execution windows). The root cause is missing validation logic. A malicious majority could exploit this to stall governance or force rushed decisions. The impact is potential paralysis or instability in oDAO decision-making.\n",
            "severity": "Low",
            "location": [
                "RocketDAONodeTrustedSettingsProposals.sol#L19-L23"
            ],
            "files": [
                "rocketpool/contracts/contract/dao/node/settings/RocketDAONodeTrustedSettingsProposals.sol"
            ]
        }
    ],
    "affected_files": {
        "RocketDAONodeTrustedSettingsProposals.sol": "pragma solidity 0.7.6;\n\n// SPDX-License-Identifier: GPL-3.0-only\n\nimport \"./RocketDAONodeTrustedSettings.sol\";\nimport \"../../../../interface/dao/node/settings/RocketDAONodeTrustedSettingsProposalsInterface.sol\";\n\n\n// The Trusted Node DAO Members \ncontract RocketDAONodeTrustedSettingsProposals is RocketDAONodeTrustedSettings, RocketDAONodeTrustedSettingsProposalsInterface { \n\n    // Construct\n    constructor(RocketStorageInterface _rocketStorageAddress) RocketDAONodeTrustedSettings(_rocketStorageAddress, \"proposals\") {\n        // Set version\n        version = 1;\n        // Initialize settings on deployment\n        if(!getBool(keccak256(abi.encodePacked(settingNameSpace, \"deployed\")))) {\n            // Init settings\n            setSettingUint(\"proposal.cooldown.time\", 2 days);               // How long before a member can make sequential proposals\n            setSettingUint(\"proposal.vote.time\", 2 weeks);                  // How long a proposal can be voted on\n            setSettingUint(\"proposal.vote.delay.time\", 1 weeks);            // How long before a proposal can be voted on after it is created\n            setSettingUint(\"proposal.execute.time\", 4 weeks);               // How long a proposal can be executed after its voting period is finished\n            setSettingUint(\"proposal.action.time\", 4 weeks);                // Certain proposals require a secondary action to be run after the proposal is successful (joining, leaving etc). This is how long until that action expires\n            // Settings initialised\n            setBool(keccak256(abi.encodePacked(settingNameSpace, \"deployed\")), true);\n        }\n    }\n\n  \n    // Getters\n\n    // How long before a member can make sequential proposals\n    function getCooldownTime() override external view returns (uint256) {\n        return getSettingUint(\"proposal.cooldown.time\");\n    }\n\n    // How long a proposal can be voted on\n    function getVoteTime() override external view returns (uint256) {\n        return getSettingUint(\"proposal.vote.time\");\n    }\n\n    // How long before a proposal can be voted on after it is created\n    function getVoteDelayTime() override external view returns (uint256) {\n        return getSettingUint(\"proposal.vote.delay.time\");\n    }\n\n    // How long a proposal can be executed after its voting period is finished\n    function getExecuteTime() override external view returns (uint256) {\n        return getSettingUint(\"proposal.execute.time\");\n    }\n\n    // Certain proposals require a secondary action to be run after the proposal is successful (joining, leaving etc). This is how long until that action expires\n    function getActionTime() override external view returns (uint256) {\n        return getSettingUint(\"proposal.action.time\");\n    }\n\n}\n"
    }
}